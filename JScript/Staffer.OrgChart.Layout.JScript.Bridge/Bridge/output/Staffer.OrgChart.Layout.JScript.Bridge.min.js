Bridge.assembly("Staffer.OrgChart.Layout.JScript.Bridge",function($asm){"use strict";Bridge.define("Staffer.OrgChart.Annotations.CanBeNullAttribute",{inherits:[System.Attribute]});Bridge.define("Staffer.OrgChart.Annotations.ContractAnnotationAttribute",{inherits:[System.Attribute],config:{properties:{Contract:null,ForceFullStates:!1}},ctor:function(contract){Staffer.OrgChart.Annotations.ContractAnnotationAttribute.$ctor1.call(this,contract,!1)},$ctor1:function(contract,forceFullStates){this.$initialize();System.Attribute.ctor.call(this);this.setContract(contract);this.setForceFullStates(forceFullStates)}});Bridge.define("Staffer.OrgChart.Annotations.NotNullAttribute",{inherits:[System.Attribute]});Bridge.define("Staffer.OrgChart.Annotations.PureAttribute",{inherits:[System.Attribute]});Bridge.define("Staffer.OrgChart.Layout.Boundary",{left:null,right:null,verticalMargin:0,m_spacerMerger:null,config:{properties:{BoundingRect:null},init:function(){this.BoundingRect=new Staffer.OrgChart.Layout.Rect}},$ctor1:function(verticalMargin){Staffer.OrgChart.Layout.Boundary.ctor.call(this,!0,verticalMargin)},ctor:function(frompublic,verticalMargin){if(this.$initialize(),verticalMargin<0)throw new System.ArgumentOutOfRangeException("verticalMargin");this.verticalMargin=verticalMargin;this.left=new(System.Collections.Generic.List$1(Staffer.OrgChart.Layout.Boundary.Step));this.right=new(System.Collections.Generic.List$1(Staffer.OrgChart.Layout.Boundary.Step));frompublic&&(this.m_spacerMerger=new Staffer.OrgChart.Layout.Boundary.ctor(!1,0))},prepareForHorizontalLayout:function(box){if(this.prepare(box),!box.disableCollisionDetection){var rect=box.frame.exterior,margin=box.isSpecial?0:this.verticalMargin;this.left.add(new Staffer.OrgChart.Layout.Boundary.Step.$ctor1(box,rect.getLeft(),rect.getTop()-margin,rect.getBottom()+margin));this.right.add(new Staffer.OrgChart.Layout.Boundary.Step.$ctor1(box,rect.getRight(),rect.getTop()-margin,rect.getBottom()+margin))}},prepare:function(box){this.left.clear();this.right.clear();this.setBoundingRect(box.frame.exterior)},verticalMergeFrom:function(other){this.setBoundingRect(Staffer.OrgChart.Layout.Rect.op_Addition(this.getBoundingRect(),other.getBoundingRect()))},mergeFrom:function(other){var merge,my,th,theirWins;if(other.getBoundingRect().getTop()>=other.getBoundingRect().getBottom())throw new System.ArgumentException("Cannot merge boundary of height "+System.Double.format(other.getBoundingRect().getBottom()-other.getBoundingRect().getTop(),"G"));for(merge=114;merge!==0;){for(var mySteps=merge===114?this.right:this.left,theirSteps=merge===114?other.right:other.left,i=0,k=0;k<theirSteps.getCount()&&i<mySteps.getCount();){if(my=mySteps.getItem(i),th=theirSteps.getItem(k),my.bottom<=th.top){i=i+1|0;continue}if(th.bottom<=my.top){mySteps.insert(i,th);k=k+1|0;this.validateState();continue}theirWins=merge===114&&my.x<=th.x||merge===108&&my.x>=th.x;my.top===th.top?my.bottom===th.bottom?(theirWins&&mySteps.setItem(i,th),i=i+1|0,k=k+1|0,this.validateState()):my.bottom<th.bottom?(theirWins&&mySteps.setItem(i,my.changeBox(th.box,th.x)),theirSteps.setItem(k,th.changeTop(my.bottom)),i=i+1|0,this.validateState()):(theirWins&&(mySteps.setItem(i,my.changeTop(th.bottom)),mySteps.insert(i,th),i=i+1|0),k=k+1|0,this.validateState()):my.bottom===th.bottom?my.top<th.top?(theirWins&&(mySteps.setItem(i,my.changeBottom(th.top)),mySteps.insert(i+1|0,th),i=i+1|0),i=i+1|0,k=k+1|0,this.validateState()):(theirWins?mySteps.setItem(i,th):(mySteps.insert(i,th.changeBottom(my.top)),i=i+1|0),i=i+1|0,k=k+1|0,this.validateState()):my.top<th.top&&my.bottom<th.bottom?(theirWins&&(mySteps.setItem(i,my.changeBottom(th.top)),mySteps.insert(i+1|0,new Staffer.OrgChart.Layout.Boundary.Step.$ctor1(th.box,th.x,th.top,my.bottom)),i=i+1|0),theirSteps.setItem(k,th.changeTop(my.bottom)),i=i+1|0,this.validateState()):my.top<th.top&&my.bottom>th.bottom?(theirWins&&(mySteps.setItem(i,my.changeBottom(th.top)),mySteps.insert(i+1|0,th),mySteps.insert(i+2|0,my.changeTop(th.bottom)),i=i+2|0),k=k+1|0,this.validateState()):my.bottom>th.bottom?(theirWins?(mySteps.setItem(i,my.changeTop(th.bottom)),mySteps.insert(i,th)):mySteps.insert(i,th.changeBottom(my.top)),i=i+1|0,k=k+1|0,this.validateState()):(theirWins?mySteps.setItem(i,th.changeBottom(my.bottom)):(mySteps.insert(i,th.changeBottom(my.top)),i=i+1|0),theirSteps.setItem(k,th.changeTop(my.bottom)),i=i+1|0,this.validateState())}if(i===mySteps.getCount())while(k<theirSteps.getCount())mySteps.add(theirSteps.getItem(k)),k=k+1|0,this.validateState();merge=merge===114?108:0}this.setBoundingRect(Staffer.OrgChart.Layout.Rect.op_Addition(this.getBoundingRect(),other.getBoundingRect()));this.validateState()},mergeFrom$1:function(box){if(!box.disableCollisionDetection){var rect=box.frame.exterior;rect.size.height!==0&&(this.m_spacerMerger.prepareForHorizontalLayout(box),this.mergeFrom(this.m_spacerMerger))}},validateState:function(){for(var i1,i=1;i<this.left.getCount();i=i+1|0)if(this.left.getItem(i).top===this.left.getItem(i).bottom||this.left.getItem(i).top<this.left.getItem(i-1|0).bottom||this.left.getItem(i).top<=this.left.getItem(i-1|0).top||this.left.getItem(i).bottom<=this.left.getItem(i).top||this.left.getItem(i).bottom<=this.left.getItem(i-1|0).bottom)throw new System.Exception("State error at Left index "+i);for(i1=1;i1<this.right.getCount();i1=i1+1|0)if(this.right.getItem(i1).top===this.right.getItem(i1).bottom||this.right.getItem(i1).top<this.right.getItem(i1-1|0).bottom||this.right.getItem(i1).top<=this.right.getItem(i1-1|0).top||this.right.getItem(i1).bottom<=this.right.getItem(i1).top||this.right.getItem(i1).bottom<=this.right.getItem(i1-1|0).bottom)throw new System.Exception("State error at Right index "+i1);},computeOverlap:function(other,siblingSpacing,branchSpacing){for(var i=0,k=0,offense=0,my,th,desiredSpacing,diff;i<this.right.getCount()&&k<other.left.getCount();)my=this.right.getItem(i),th=other.left.getItem(k),my.bottom<=th.top?i=i+1|0:th.bottom<=my.top?k=k+1|0:(my.box.disableCollisionDetection||th.box.disableCollisionDetection||(desiredSpacing=my.box.isSpecial||th.box.isSpecial?0:my.box.parentId===th.box.parentId?siblingSpacing:branchSpacing,diff=my.x+desiredSpacing-th.x,diff>offense&&(offense=diff)),my.bottom>=th.bottom&&(k=k+1|0),th.bottom>=my.bottom&&(i=i+1|0));return offense},reloadFromBranch:function(branchRoot){for(var left,rect,i1,right,rect1,leftmost=System.Double.max,rightmost=System.Double.min,i=0;i<this.left.getCount();i=i+1|0)left=this.left.getItem(i),rect=left.box.frame.exterior,this.left.setItem(i,left.changeBox(left.box,rect.getLeft())),leftmost=Math.min(leftmost,rect.getLeft());for(i1=0;i1<this.right.getCount();i1=i1+1|0)right=this.right.getItem(i1),rect1=right.box.frame.exterior,this.right.setItem(i1,right.changeBox(right.box,rect1.getRight())),rightmost=Math.max(rightmost,rect1.getRight());leftmost=Math.min(branchRoot.getElement().frame.exterior.getLeft(),leftmost);rightmost=Math.max(branchRoot.getElement().frame.exterior.getRight(),rightmost);this.setBoundingRect(new Staffer.OrgChart.Layout.Rect.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(leftmost,this.getBoundingRect().getTop()),new Staffer.OrgChart.Layout.Size.$ctor1(rightmost-leftmost,this.getBoundingRect().size.height)))}});Bridge.define("Staffer.OrgChart.Layout.Boundary.Step",{$kind:"struct",statics:{getDefaultValue:function(){return new Staffer.OrgChart.Layout.Boundary.Step}},box:null,x:0,top:0,bottom:0,$ctor1:function(box,x,top,bottom){this.$initialize();this.box=box;this.x=x;this.top=top;this.bottom=bottom},ctor:function(){this.$initialize()},changeTop:function(newTop){return new Staffer.OrgChart.Layout.Boundary.Step.$ctor1(this.box,this.x,newTop,this.bottom)},changeBottom:function(newBottom){return new Staffer.OrgChart.Layout.Boundary.Step.$ctor1(this.box,this.x,this.top,newBottom)},changeBox:function(newBox,newX){return new Staffer.OrgChart.Layout.Boundary.Step.$ctor1(newBox,newX,this.top,this.bottom)},getHashCode:function(){return Bridge.addHash([1885697107,this.box,this.x,this.top,this.bottom])},equals:function(o){return Bridge.is(o,Staffer.OrgChart.Layout.Boundary.Step)?Bridge.equals(this.box,o.box)&&Bridge.equals(this.x,o.x)&&Bridge.equals(this.top,o.top)&&Bridge.equals(this.bottom,o.bottom):!1},$clone:function(to){var s=to||new Staffer.OrgChart.Layout.Boundary.Step;return s.box=this.box,s.x=this.x,s.top=this.top,s.bottom=this.bottom,s}});Bridge.define("Staffer.OrgChart.Layout.BoundaryChangedEventArgs",{state:null,layoutLevel:null,boundary:null,ctor:function(boundary,layoutLevel,state){this.$initialize();this.boundary=boundary;this.layoutLevel=layoutLevel;this.state=state}});Bridge.define("Staffer.OrgChart.Layout.Box",{statics:{None:-1,special:function(id,visualParentId,disableCollisionDetection){return new Staffer.OrgChart.Layout.Box.$ctor1(null,id,visualParentId,!0,disableCollisionDetection,!1)}},id:0,parentId:0,dataId:null,isSpecial:!1,isAssistant:!1,disableCollisionDetection:!1,layoutStrategyId:null,assistantLayoutStrategyId:null,frame:null,isCollapsed:!1,affectsLayout:!1,ctor:function(dataId,id,parentId,isAssistant){Staffer.OrgChart.Layout.Box.$ctor1.call(this,dataId,id,parentId,!1,!1,isAssistant)},$ctor1:function(dataId,id,parentId,isSpecial,disableCollisionDetection,isAssistant){if(this.$initialize(),id===0)throw new System.ArgumentOutOfRangeException("id");this.id=id;this.parentId=parentId;this.dataId=dataId;this.frame=new Staffer.OrgChart.Layout.Frame;this.isSpecial=isSpecial;this.isAssistant=isAssistant;this.affectsLayout=!0;this.disableCollisionDetection=disableCollisionDetection},getIsDataBound:function(){return!System.String.isNullOrEmpty(this.dataId)}});Bridge.define("Staffer.OrgChart.Layout.BoxContainer",{m_lastBoxId:0,m_boxesById:null,m_boxesByDataId:null,config:{properties:{SystemRoot:null},init:function(){this.m_boxesById=new(System.Collections.Generic.Dictionary$2(System.Int32,Staffer.OrgChart.Layout.Box));this.m_boxesByDataId=new(System.Collections.Generic.Dictionary$2(String,Staffer.OrgChart.Layout.Box))}},ctor:function(){this.$initialize()},$ctor1:function(source){this.$initialize();this.reloadBoxes(source)},getBoxesById:function(){return this.m_boxesById},getBoxesByDataId:function(){return this.m_boxesByDataId},reloadBoxes:function(source){var $t,$t1,map,dataId,getDataItem;for(this.m_boxesByDataId.clear(),this.m_boxesById.clear(),this.m_lastBoxId=0,this.setSystemRoot(Staffer.OrgChart.Layout.Box.special(this.m_lastBoxId=this.m_lastBoxId+1|0,Staffer.OrgChart.Layout.Box.None,!0)),this.m_boxesById.add(this.getSystemRoot().id,this.getSystemRoot()),map=new(System.Collections.Generic.Dictionary$2(String,System.Int32)),$t=Bridge.getEnumerator(source.Staffer$OrgChart$Layout$IChartDataSource$getAllDataItemIds(),String);$t.moveNext();)dataId=$t.getCurrent(),map.add(dataId,this.nextBoxId());for(getDataItem=source.Staffer$OrgChart$Layout$IChartDataSource$getGetDataItemFunc(),$t1=Bridge.getEnumerator(source.Staffer$OrgChart$Layout$IChartDataSource$getAllDataItemIds(),String);$t1.moveNext();){var dataId1=$t1.getCurrent(),parentDataId=System.String.isNullOrEmpty(dataId1)?null:source.Staffer$OrgChart$Layout$IChartDataSource$getGetParentKeyFunc()(dataId1),visualParentId=System.String.isNullOrEmpty(parentDataId)?this.getSystemRoot().id:map.get(parentDataId);this.addBox$1(dataId1,map.get(dataId1),visualParentId,getDataItem(dataId1).Staffer$OrgChart$Layout$IChartDataItem$getIsAssistant())}},addBox:function(dataId,visualParentId,isAssistant){return this.addBox$1(dataId,this.nextBoxId(),visualParentId,isAssistant)},addBox$1:function(dataId,id,visualParentId,isAssistant){var box=new Staffer.OrgChart.Layout.Box.ctor(dataId,id,visualParentId,isAssistant);return this.m_boxesById.add(box.id,box),System.String.isNullOrEmpty(dataId)||this.m_boxesByDataId.add(box.dataId,box),box},nextBoxId:function(){return this.m_lastBoxId=this.m_lastBoxId+1|0,this.m_lastBoxId}});Bridge.define("Staffer.OrgChart.Layout.NodeLayoutInfo",{numberOfSiblings:0,numberOfSiblingRows:0,numberOfSiblingColumns:0,m_effectiveLayoutStrategy:null,setEffectiveLayoutStrategy:function(value){this.m_effectiveLayoutStrategy=value},requireLayoutStrategy:function(){if(this.m_effectiveLayoutStrategy==null)throw new System.Exception("effectiveLayoutStrategy is not set");return this.m_effectiveLayoutStrategy}});Bridge.define("Staffer.OrgChart.Misc.Tree$3",function(TKey,TValue,TValueState){return{config:{properties:{Roots:null,Nodes:null,GetKeyFunc:null,GetParentKeyFunc:null,Depth:0}},ctor:function(getParentKeyFunc,getKeyFunc){this.$initialize();this.setGetParentKeyFunc(getParentKeyFunc);this.setGetKeyFunc(getKeyFunc);this.setRoots(new(System.Collections.Generic.List$1(Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState))));this.setNodes(new(System.Collections.Generic.Dictionary$2(TKey,Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState))))},iterateChildFirst:function(func){for(var root,$t=Bridge.getEnumerator(this.getRoots());$t.moveNext();)if(root=$t.getCurrent(),!Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState).iterateChildFirst(root,func))return!1;return!0},iterateParentFirst:function(func){for(var root,$t=Bridge.getEnumerator(this.getRoots());$t.moveNext();)root=$t.getCurrent(),Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState).iterateParentFirst(root,func)},updateHierarchyStats:function(){this.setDepth(0);this.iterateParentFirst(Bridge.fn.bind(this,$asm.$.Staffer.OrgChart.Misc.Tree$3.f1))}}});Bridge.ns("Staffer.OrgChart.Misc.Tree$3",$asm.$);Bridge.apply($asm.$.Staffer.OrgChart.Misc.Tree$3,{f1:function(x){return x.getParentNode()!=null?(x.setLevel(x.getParentNode().getLevel()+1|0),this.setDepth(Math.max(1+x.getLevel()|0,this.getDepth()))):(x.setLevel(0),this.setDepth(1)),!0}});Bridge.define("Staffer.OrgChart.Layout.BranchParentAlignment",{$kind:"enum",statics:{InvalidValue:0,Left:1,Center:2,Right:3}});Bridge.define("Staffer.OrgChart.Layout.Connector",{config:{properties:{Segments:null}},ctor:function(segments){if(this.$initialize(),segments.length===0)throw new System.ArgumentException("Need at least one segment","segments");this.setSegments(segments)}});Bridge.define("Staffer.OrgChart.Layout.Diagram",{m_visualTree:null,m_boxes:null,config:{properties:{LayoutSettings:null}},ctor:function(){this.$initialize();this.setLayoutSettings(new Staffer.OrgChart.Layout.DiagramLayoutSettings)},getBoxes:function(){return this.m_boxes},setBoxes:function(value){this.m_visualTree=null;this.m_boxes=value},getVisualTree:function(){return this.m_visualTree},setVisualTree:function(value){this.m_visualTree=value}});Bridge.define("Staffer.OrgChart.Layout.DiagramLayoutSettings",{m_branchSpacing:0,config:{properties:{LayoutStrategies:null,DefaultAssistantLayoutStrategyId:null,DefaultLayoutStrategyId:null,BoxVerticalMargin:0}},ctor:function(){this.$initialize();this.setBranchSpacing(50);this.setBoxVerticalMargin(5);this.setLayoutStrategies(new(System.Collections.Generic.Dictionary$2(String,Staffer.OrgChart.Layout.LayoutStrategyBase)))},getBranchSpacing:function(){return this.m_branchSpacing},setBranchSpacing:function(value){if(value<0)throw new System.ArgumentOutOfRangeException("value","Cannot be negative",null,value);this.m_branchSpacing=value},requireDefaultLayoutStrategy:function(){var result={};if(System.String.isNullOrEmpty(this.getDefaultLayoutStrategyId())||!this.getLayoutStrategies().tryGetValue(this.getDefaultLayoutStrategyId(),result))throw new System.InvalidOperationException("defaultLayoutStrategyId is null or not valid");return result.v},requireDefaultAssistantLayoutStrategy:function(){var result={};if(System.String.isNullOrEmpty(this.getDefaultAssistantLayoutStrategyId())||!this.getLayoutStrategies().tryGetValue(this.getDefaultAssistantLayoutStrategyId(),result))throw new System.InvalidOperationException("defaultAssistantLayoutStrategyId is null or not valid");return result.v}});Bridge.define("Staffer.OrgChart.Layout.DiagramLayoutTemplates");Bridge.define("Staffer.OrgChart.Layout.Dimensions",{$kind:"struct",statics:{minMax:function(){return new Staffer.OrgChart.Layout.Dimensions.$ctor1(System.Double.max,System.Double.min)},op_Addition:function(x,y){return new Staffer.OrgChart.Layout.Dimensions.$ctor1(Math.min(x.from,y.from),Math.max(x.to,y.to))},getDefaultValue:function(){return new Staffer.OrgChart.Layout.Dimensions}},from:0,to:0,$ctor1:function(from,to){this.$initialize();this.from=from;this.to=to},ctor:function(){this.$initialize()},getHashCode:function(){return Bridge.addHash([3570880544,this.from,this.to])},equals:function(o){return Bridge.is(o,Staffer.OrgChart.Layout.Dimensions)?Bridge.equals(this.from,o.from)&&Bridge.equals(this.to,o.to):!1},$clone:function(to){var s=to||new Staffer.OrgChart.Layout.Dimensions;return s.from=this.from,s.to=this.to,s}});Bridge.define("Staffer.OrgChart.Layout.Edge",{$kind:"struct",statics:{getDefaultValue:function(){return new Staffer.OrgChart.Layout.Edge}},config:{init:function(){this.from=new Staffer.OrgChart.Layout.Point;this.to=new Staffer.OrgChart.Layout.Point}},$ctor1:function(from,to){this.$initialize();this.from=from;this.to=to},ctor:function(){this.$initialize()},getHashCode:function(){return Bridge.addHash([1701274693,this.from,this.to])},equals:function(o){return Bridge.is(o,Staffer.OrgChart.Layout.Edge)?Bridge.equals(this.from,o.from)&&Bridge.equals(this.to,o.to):!1},$clone:function(to){var s=to||new Staffer.OrgChart.Layout.Edge;return s.from=this.from,s.to=this.to,s}});Bridge.define("Staffer.OrgChart.Layout.LayoutStrategyBase",{parentAlignment:0,parentChildSpacing:20,parentConnectorShield:50,siblingSpacing:20,childConnectorHookLength:5});Bridge.define("Staffer.OrgChart.Layout.Frame",{connector:null,config:{init:function(){this.exterior=new Staffer.OrgChart.Layout.Rect;this.branchExterior=new Staffer.OrgChart.Layout.Rect;this.siblingsRowV=new Staffer.OrgChart.Layout.Dimensions}},resetLayout:function(){this.exterior=new Staffer.OrgChart.Layout.Rect.$ctor1(new Staffer.OrgChart.Layout.Point.ctor,this.exterior.size);this.branchExterior=this.exterior;this.connector=null;this.siblingsRowV=Staffer.OrgChart.Layout.Dimensions.minMax()},copyExteriorFrom:function(other){this.exterior=other.exterior;this.branchExterior=other.branchExterior;this.siblingsRowV=other.siblingsRowV}});Bridge.define("Staffer.OrgChart.Layout.IChartDataItem",{$kind:"interface"});Bridge.define("Staffer.OrgChart.Layout.IChartDataSource",{$kind:"interface"});Bridge.define("Staffer.OrgChart.Layout.LayoutAlgorithm",{statics:{computeBranchVisualBoundingRect:function(visualTree){var result=new Staffer.OrgChart.Layout.Rect.ctor,initialized=!1;return Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo).iterateParentFirst(visualTree.getRoots().getItem(0),function(node){var box=node.getElement();return box.affectsLayout&&!box.isSpecial&&(initialized?result=Staffer.OrgChart.Layout.Rect.op_Addition(result,box.frame.exterior):(initialized=!0,result=box.frame.exterior)),!box.isCollapsed}),result},resetBoxPositions:function(diagram){for(var box,$t=Bridge.getEnumerator(diagram.getBoxes().getBoxesById().System$Collections$Generic$IDictionary$2$System$Int32$Staffer$OrgChart$Layout$Box$getValues(),Staffer.OrgChart.Layout.Box);$t.moveNext();)box=$t.getCurrent(),box.frame.resetLayout()},apply:function(state){var $t,tree,box;if(state.getDiagram().getBoxes().getSystemRoot()==null)throw new System.InvalidOperationException("SystemRoot is not initialized on the box container");if(state.setCurrentOperation(Staffer.OrgChart.Layout.LayoutState.Operation.Preparing),tree=Staffer.OrgChart.Layout.BoxTree.build(state.getDiagram().getBoxes().getBoxesById().System$Collections$Generic$IDictionary$2$System$Int32$Staffer$OrgChart$Layout$Box$getValues(),$asm.$.Staffer.OrgChart.Layout.LayoutAlgorithm.f1,$asm.$.Staffer.OrgChart.Layout.LayoutAlgorithm.f2),state.getDiagram().setVisualTree(tree),tree.getRoots().getCount()!==1||tree.getRoots().getItem(0).getElement().id!==state.getDiagram().getBoxes().getSystemRoot().id)throw new System.Exception("SystemRoot is not on the top of the visual tree");if(tree.updateHierarchyStats(),state.attachVisualTree(tree),!Bridge.staticEquals(state.getBoxSizeFunc(),null))for($t=Bridge.getEnumerator(System.Linq.Enumerable.from(state.getDiagram().getBoxes().getBoxesById().System$Collections$Generic$IDictionary$2$System$Int32$Staffer$OrgChart$Layout$Box$getValues()).where($asm.$.Staffer.OrgChart.Layout.LayoutAlgorithm.f3));$t.moveNext();)box=$t.getCurrent(),box.frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor2(state.getBoxSizeFunc()(box.dataId));tree.iterateParentFirst($asm.$.Staffer.OrgChart.Layout.LayoutAlgorithm.f4);state.setCurrentOperation(Staffer.OrgChart.Layout.LayoutState.Operation.PreprocessVisualTree);Staffer.OrgChart.Layout.LayoutAlgorithm.preprocessVisualTree(state,tree);state.setCurrentOperation(Staffer.OrgChart.Layout.LayoutState.Operation.VerticalLayout);Staffer.OrgChart.Layout.LayoutAlgorithm.verticalLayout(state,tree.getRoots().getItem(0));state.setCurrentOperation(Staffer.OrgChart.Layout.LayoutState.Operation.HorizontalLayout);Staffer.OrgChart.Layout.LayoutAlgorithm.horizontalLayout(state,tree.getRoots().getItem(0));state.setCurrentOperation(Staffer.OrgChart.Layout.LayoutState.Operation.ConnectorsLayout);Staffer.OrgChart.Layout.LayoutAlgorithm.routeConnectors(state,tree);state.setCurrentOperation(Staffer.OrgChart.Layout.LayoutState.Operation.Completed)},preprocessVisualTree:function(state,visualTree){var defaultStrategyId=state.getDiagram().getLayoutSettings().getDefaultLayoutStrategyId(),defaultStrategy=state.getDiagram().getLayoutSettings().requireDefaultLayoutStrategy(),defaultAssistantsStrategyId=state.getDiagram().getLayoutSettings().getDefaultAssistantLayoutStrategyId(),defaultAssistantsStrategy=state.getDiagram().getLayoutSettings().requireDefaultAssistantLayoutStrategy();visualTree.iterateParentFirst(function(node){var $t,found=null,parent,parent1;if(($t=node.getParentNode())!=null?$t.getAssistantsRoot():Bridge.referenceEquals(null,node)){for(parent=node;parent!=null;){if(parent.getElement().assistantLayoutStrategyId!=null){found=state.getDiagram().getLayoutSettings().getLayoutStrategies().get(parent.getElement().assistantLayoutStrategyId);break}parent=parent.getParentNode()}found==null&&(found=defaultAssistantsStrategy)}else{for(parent1=node;parent1!=null;){if(parent1.getElement().layoutStrategyId!=null){found=state.getDiagram().getLayoutSettings().getLayoutStrategies().get(parent1.getElement().layoutStrategyId);break}parent1=parent1.getParentNode()}found==null&&(found=defaultStrategy)}return node.getState().setEffectiveLayoutStrategy(found),node.getState().requireLayoutStrategy().preProcessThisNode(state,node),!node.getElement().isCollapsed&&node.getChildCount()>0||node.getAssistantsRoot()!=null})},horizontalLayout:function(state,branchRoot){if(!branchRoot.getElement().affectsLayout)throw new System.InvalidOperationException(System.String.format("Branch root {0} does not affect layout",branchRoot.getElement().id));var level=state.pushLayoutLevel(branchRoot);try{(branchRoot.getLevel()===0||(branchRoot.getState().numberOfSiblings>0||branchRoot.getAssistantsRoot()!=null)&&!branchRoot.getElement().isCollapsed)&&branchRoot.getState().requireLayoutStrategy().applyHorizontalLayout(state,level)}finally{state.popLayoutLevel()}},verticalLayout:function(state,branchRoot){if(!branchRoot.getElement().affectsLayout)throw new System.InvalidOperationException(System.String.format("Branch root {0} does not affect layout",branchRoot.getElement().id));var level=state.pushLayoutLevel(branchRoot);try{(branchRoot.getLevel()===0||(branchRoot.getState().numberOfSiblings>0||branchRoot.getAssistantsRoot()!=null)&&!branchRoot.getElement().isCollapsed)&&branchRoot.getState().requireLayoutStrategy().applyVerticalLayout(state,level)}finally{state.popLayoutLevel()}},routeConnectors:function(state,visualTree){visualTree.iterateParentFirst(function(node){return node.getElement().isCollapsed||node.getState().numberOfSiblings===0&&node.getAssistantsRoot()==null?!1:node.getLevel()===0?!0:!node.getElement().isSpecial||node.getIsAssistantRoot()?(node.getState().requireLayoutStrategy().routeConnectors(state,node),!0):!1})},moveChildrenOnly:function(state,layoutLevel,offset){var $t,children=layoutLevel.branchRoot.getChildren(),action,child;if(children==null||System.Array.getCount(children,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo))===0)throw new System.InvalidOperationException("Should never be invoked when children not set");for(action=function(node){return node.getElement().affectsLayout&&(node.getElement().frame.exterior=node.getElement().frame.exterior.moveH(offset),node.getElement().frame.branchExterior=node.getElement().frame.branchExterior.moveH(offset)),!0},$t=Bridge.getEnumerator(children,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo));$t.moveNext();)child=$t.getCurrent(),Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo).iterateChildFirst(child,action);layoutLevel.boundary.reloadFromBranch(layoutLevel.branchRoot);layoutLevel.branchRoot.getElement().frame.branchExterior=layoutLevel.boundary.getBoundingRect()},moveOneChild:function(state,root,offset){Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo).iterateChildFirst(root,function(node){return node.getElement().affectsLayout&&(node.getElement().frame.exterior=node.getElement().frame.exterior.moveH(offset),node.getElement().frame.branchExterior=node.getElement().frame.branchExterior.moveH(offset)),!0})},moveBranch:function(state,layoutLevel,offset){Staffer.OrgChart.Layout.LayoutAlgorithm.moveOneChild(state,layoutLevel.branchRoot,offset);layoutLevel.boundary.reloadFromBranch(layoutLevel.branchRoot);layoutLevel.branchRoot.getElement().frame.branchExterior=layoutLevel.boundary.getBoundingRect()},alignHorizontalCenters:function(state,level,subset){for(var $t1,center=System.Double.min,child,c,leftmost,rightmost,diff,$t=Bridge.getEnumerator(subset,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo));$t.moveNext();)child=$t.getCurrent(),c=child.getElement().frame.exterior.getCenterH(),c>center&&(center=c);for(leftmost=System.Double.max,rightmost=System.Double.min,$t1=Bridge.getEnumerator(subset,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo));$t1.moveNext();){var child1=$t1.getCurrent(),frame=child1.getElement().frame,c1=frame.exterior.getCenterH();c1!==center&&(diff=center-c1,Staffer.OrgChart.Layout.LayoutAlgorithm.moveOneChild(state,child1,diff));leftmost=Math.min(leftmost,child1.getElement().frame.branchExterior.getLeft());rightmost=Math.max(rightmost,child1.getElement().frame.branchExterior.getRight())}return level.boundary.reloadFromBranch(level.branchRoot),new Staffer.OrgChart.Layout.Dimensions.$ctor1(leftmost,rightmost)}}});Bridge.ns("Staffer.OrgChart.Layout.LayoutAlgorithm",$asm.$);Bridge.apply($asm.$.Staffer.OrgChart.Layout.LayoutAlgorithm,{f1:function(x){return x.id},f2:function(x){return x.parentId},f3:function(x){return x.getIsDataBound()},f4:function(node){return node.getElement().affectsLayout=node.getParentNode()==null||node.getParentNode().getElement().affectsLayout&&!node.getParentNode().getElement().isCollapsed,!0}});Bridge.define("Staffer.OrgChart.Layout.LayoutState",{m_layoutStack:null,m_pooledBoundaries:null,m_currentOperation:0,config:{events:{BoundaryChanged:null,OperationChanged:null},properties:{Diagram:null,BoxSizeFunc:null},init:function(){this.m_layoutStack=new(System.Collections.Generic.Stack$1(Staffer.OrgChart.Layout.LayoutState.LayoutLevel).ctor);this.m_pooledBoundaries=new(System.Collections.Generic.List$1(Staffer.OrgChart.Layout.Boundary))}},ctor:function(diagram){this.$initialize();this.setDiagram(diagram)},getCurrentOperation:function(){return this.m_currentOperation},setCurrentOperation:function(value){this.m_currentOperation=value;Bridge.staticEquals(this.OperationChanged,null)?null:this.OperationChanged(this,new Staffer.OrgChart.Layout.LayoutStateOperationChangedEventArgs(this))},attachVisualTree:function(tree){for(var i=0;i<tree.getDepth();i=i+1|0)this.m_pooledBoundaries.add(new Staffer.OrgChart.Layout.Boundary.$ctor1(this.getDiagram().getLayoutSettings().getBoxVerticalMargin()))},pushLayoutLevel:function(node){var boundary,result;this.m_pooledBoundaries.getCount()===0&&this.m_pooledBoundaries.add(new Staffer.OrgChart.Layout.Boundary.$ctor1(this.getDiagram().getLayoutSettings().getBoxVerticalMargin()));boundary=this.m_pooledBoundaries.getItem(this.m_pooledBoundaries.getCount()-1|0);this.m_pooledBoundaries.removeAt(this.m_pooledBoundaries.getCount()-1|0);switch(this.getCurrentOperation()){case Staffer.OrgChart.Layout.LayoutState.Operation.VerticalLayout:boundary.prepare(node.getElement());break;case Staffer.OrgChart.Layout.LayoutState.Operation.HorizontalLayout:boundary.prepareForHorizontalLayout(node.getElement());break;default:throw new System.InvalidOperationException("This operation can only be invoked when performing vertical or horizontal layouts");}return result=new Staffer.OrgChart.Layout.LayoutState.LayoutLevel(node,boundary),this.m_layoutStack.push(result),Bridge.staticEquals(this.BoundaryChanged,null)?null:this.BoundaryChanged(this,new Staffer.OrgChart.Layout.BoundaryChangedEventArgs(boundary,result,this)),result},mergeSpacer:function(spacerBox){if(this.getCurrentOperation()!==Staffer.OrgChart.Layout.LayoutState.Operation.HorizontalLayout)throw new System.InvalidOperationException("Spacers can only be merged during horizontal layout");if(this.m_layoutStack.getCount()===0)throw new System.InvalidOperationException("Cannot merge spacers at top nesting level");var level=this.m_layoutStack.peek();level.boundary.mergeFrom$1(spacerBox);Bridge.staticEquals(this.BoundaryChanged,null)?null:this.BoundaryChanged(this,new Staffer.OrgChart.Layout.BoundaryChangedEventArgs(level.boundary,level,this))},popLayoutLevel:function(){var innerLevel=this.m_layoutStack.pop(),higherLevel,strategy,overlap;if(Bridge.staticEquals(this.BoundaryChanged,null)?null:this.BoundaryChanged(this,new Staffer.OrgChart.Layout.BoundaryChangedEventArgs(innerLevel.boundary,innerLevel,this)),this.m_layoutStack.getCount()>0){higherLevel=this.m_layoutStack.peek();switch(this.getCurrentOperation()){case Staffer.OrgChart.Layout.LayoutState.Operation.VerticalLayout:higherLevel.boundary.verticalMergeFrom(innerLevel.boundary);higherLevel.branchRoot.getElement().frame.branchExterior=higherLevel.boundary.getBoundingRect();break;case Staffer.OrgChart.Layout.LayoutState.Operation.HorizontalLayout:Bridge.referenceEquals(higherLevel.branchRoot.getAssistantsRoot(),innerLevel.branchRoot)||(strategy=higherLevel.branchRoot.getState().requireLayoutStrategy(),overlap=higherLevel.boundary.computeOverlap(innerLevel.boundary,strategy.siblingSpacing,this.getDiagram().getLayoutSettings().getBranchSpacing()),overlap>0&&(Staffer.OrgChart.Layout.LayoutAlgorithm.moveBranch(this,innerLevel,overlap),Bridge.staticEquals(this.BoundaryChanged,null)?null:this.BoundaryChanged(this,new Staffer.OrgChart.Layout.BoundaryChangedEventArgs(innerLevel.boundary,innerLevel,this))));higherLevel.boundary.mergeFrom(innerLevel.boundary);higherLevel.branchRoot.getElement().frame.branchExterior=new Staffer.OrgChart.Layout.Rect.$ctor3(higherLevel.boundary.getBoundingRect().getLeft(),higherLevel.branchRoot.getElement().frame.branchExterior.getTop(),higherLevel.boundary.getBoundingRect().size.width,higherLevel.branchRoot.getElement().frame.branchExterior.size.height);break;default:throw new System.InvalidOperationException("This operation can only be invoked when performing vertical or horizontal layouts");}Bridge.staticEquals(this.BoundaryChanged,null)?null:this.BoundaryChanged(this,new Staffer.OrgChart.Layout.BoundaryChangedEventArgs(higherLevel.boundary,higherLevel,this))}this.m_pooledBoundaries.add(innerLevel.boundary)}});Bridge.define("Staffer.OrgChart.Layout.LayoutState.LayoutLevel",{branchRoot:null,boundary:null,ctor:function(node,boundary){this.$initialize();this.branchRoot=node;this.boundary=boundary}});Bridge.define("Staffer.OrgChart.Layout.LayoutState.Operation",{$kind:"enum",statics:{Idle:0,Preparing:1,PreprocessVisualTree:2,VerticalLayout:3,HorizontalLayout:4,ConnectorsLayout:5,Completed:6}});Bridge.define("Staffer.OrgChart.Layout.LayoutStateOperationChangedEventArgs",{state:null,ctor:function(state){this.$initialize();this.state=state}});Bridge.define("Staffer.OrgChart.Layout.MultiLineFishboneLayoutStrategy.SingleFishboneLayoutAdapter.GroupIterator",{m_numberOfSiblings:0,m_numberOfGroups:0,group:0,fromIndex:0,count:0,maxOnLeft:0,ctor:function(numberOfSiblings,numberOfGroups){this.$initialize();this.m_numberOfSiblings=numberOfSiblings;this.m_numberOfGroups=numberOfGroups},countInGroup:function(){for(var countInRow=this.m_numberOfGroups*2|0,result=0,countToThisGroup=(this.group*2|0)+2|0,firstInRow=0,countInThisRow;;){if(countInThisRow=firstInRow>=(this.m_numberOfSiblings-countInRow|0)?this.m_numberOfSiblings-firstInRow|0:countInRow,countInThisRow>=countToThisGroup)result=result+2|0;else{countToThisGroup=countToThisGroup-1|0;countInThisRow>=countToThisGroup&&(result=result+1|0);break}firstInRow=firstInRow+countInRow|0}return result},nextGroup:function(){return this.fromIndex=this.fromIndex+this.count|0,this.fromIndex>0&&(this.group=this.group+1|0),this.count=this.countInGroup(),this.maxOnLeft=(Bridge.Int.div(this.count,2)|0)+this.count%2|0,this.count!==0}});Bridge.define("Staffer.OrgChart.Misc.Tree$3.TreeNode",function(TKey,TValue,TValueState){return{statics:{iterateChildFirst:function(root,func){var $t,child;if(root.getAssistantsRoot()!=null&&!Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState).iterateChildFirst(root.getAssistantsRoot(),func))return!1;if(root.getChildren()!=null)for($t=Bridge.getEnumerator(root.getChildren(),Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState));$t.moveNext();)if(child=$t.getCurrent(),!Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState).iterateChildFirst(child,func))return!1;return func(root)},iterateParentFirst:function(root,func){var $t,child;if(!func(root))return!1;if(root.getAssistantsRoot()!=null&&Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState).iterateParentFirst(root.getAssistantsRoot(),func),root.getChildren()!=null)for($t=Bridge.getEnumerator(root.getChildren(),Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState));$t.moveNext();)child=$t.getCurrent(),Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState).iterateParentFirst(child,func);return!0}},config:{properties:{Level:0,Element:Bridge.getDefaultValue(TValue),State:Bridge.getDefaultValue(TValueState),ParentNode:null,Children:null,AssistantsRoot:null}},ctor:function(element){this.$initialize();this.setElement(element);this.setState(Bridge.createInstance(TValueState))},getChildCount:function(){return this.getChildren()==null?0:System.Array.getCount(this.getChildren(),Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState))},getIsAssistantRoot:function(){var $t;return($t=this.getParentNode())!=null?$t.getAssistantsRoot():Bridge.referenceEquals(null,this)},addAssistantChild:function(child,rootGen){return this.getAssistantsRoot()==null&&this.setAssistantsRoot(Bridge.merge(new(Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState))(rootGen()),{setParentNode:this,setLevel:this.getLevel()+1|0})),this.getAssistantsRoot().addRegularChild$1(child),this},addRegularChild$1:function(child){return this.insertRegularChild$1(this.getChildCount(),child)},addRegularChild:function(child){return this.insertRegularChild(this.getChildCount(),child)},insertRegularChild:function(index,child){return this.insertRegularChild$1(index,new(Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState))(child))},insertRegularChild$1:function(index,child){return this.getChildren()==null&&this.setChildren(new(System.Collections.Generic.List$1(Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState)))),System.Array.insert(this.getChildren(),index,child,Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState)),child.setParentNode(this),child.setLevel(this.getLevel()+1|0),this}}});Bridge.define("Staffer.OrgChart.Layout.Point",{$kind:"struct",statics:{getDefaultValue:function(){return new Staffer.OrgChart.Layout.Point}},x:0,y:0,$ctor1:function(x,y){this.$initialize();this.x=x;this.y=y},ctor:function(){this.$initialize()},getHashCode:function(){return Bridge.addHash([1852403652,this.x,this.y])},equals:function(o){return Bridge.is(o,Staffer.OrgChart.Layout.Point)?Bridge.equals(this.x,o.x)&&Bridge.equals(this.y,o.y):!1},$clone:function(to){var s=to||new Staffer.OrgChart.Layout.Point;return s.x=this.x,s.y=this.y,s}});Bridge.define("Staffer.OrgChart.Layout.Rect",{$kind:"struct",statics:{op_Addition:function(x,y){var left=Math.min(x.getLeft(),y.getLeft()),top=Math.min(x.getTop(),y.getTop()),right=Math.max(x.getRight(),y.getRight()),bottom=Math.max(x.getBottom(),y.getBottom());return new Staffer.OrgChart.Layout.Rect.$ctor3(left,top,right-left,bottom-top)},getDefaultValue:function(){return new Staffer.OrgChart.Layout.Rect}},config:{init:function(){this.topLeft=new Staffer.OrgChart.Layout.Point;this.size=new Staffer.OrgChart.Layout.Size}},$ctor3:function(x,y,w,h){if(this.$initialize(),w<0)throw new System.ArgumentOutOfRangeException("w");if(h<0)throw new System.ArgumentOutOfRangeException("h");this.topLeft=new Staffer.OrgChart.Layout.Point.$ctor1(x,y);this.size=new Staffer.OrgChart.Layout.Size.$ctor1(w,h)},$ctor1:function(topLeft,size){this.$initialize();this.topLeft=topLeft;this.size=size},$ctor2:function(size){this.$initialize();this.topLeft=new Staffer.OrgChart.Layout.Point.$ctor1(0,0);this.size=size},ctor:function(){this.$initialize()},getBottomRight:function(){return new Staffer.OrgChart.Layout.Point.$ctor1(this.topLeft.x+this.size.width,this.topLeft.y+this.size.height)},getLeft:function(){return this.topLeft.x},getRight:function(){return this.topLeft.x+this.size.width},getCenterH:function(){return this.topLeft.x+this.size.width/2},getCenterV:function(){return this.topLeft.y+this.size.height/2},getTop:function(){return this.topLeft.y},getBottom:function(){return this.topLeft.y+this.size.height},moveH:function(offsetX){return new Staffer.OrgChart.Layout.Rect.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(this.getLeft()+offsetX,this.getTop()),this.size)},getHashCode:function(){return Bridge.addHash([1952671058,this.topLeft,this.size])},equals:function(o){return Bridge.is(o,Staffer.OrgChart.Layout.Rect)?Bridge.equals(this.topLeft,o.topLeft)&&Bridge.equals(this.size,o.size):!1},$clone:function(to){var s=to||new Staffer.OrgChart.Layout.Rect;return s.topLeft=this.topLeft,s.size=this.size,s}});Bridge.define("Staffer.OrgChart.Layout.Size",{$kind:"struct",statics:{getDefaultValue:function(){return new Staffer.OrgChart.Layout.Size}},width:0,height:0,$ctor1:function(w,h){this.$initialize();this.width=w;this.height=h},ctor:function(){this.$initialize()},getHashCode:function(){return Bridge.addHash([1702521171,this.width,this.height])},equals:function(o){return Bridge.is(o,Staffer.OrgChart.Layout.Size)?Bridge.equals(this.width,o.width)&&Bridge.equals(this.height,o.height):!1},$clone:function(to){var s=to||new Staffer.OrgChart.Layout.Size;return s.width=this.width,s.height=this.height,s}});Bridge.define("Staffer.OrgChart.Test.TestDataGen",{statics:{generateBoxSizes:function(boxContainer){var $t,seed=0,random,box;for(System.Diagnostics.Debug.writeln(seed.toString()),random=new System.Random.$ctor1(seed),$t=Bridge.getEnumerator(boxContainer.getBoxesById().System$Collections$Generic$IDictionary$2$System$Int32$Staffer$OrgChart$Layout$Box$getValues(),Staffer.OrgChart.Layout.Box);$t.moveNext();)box=$t.getCurrent(),box.isSpecial||(box.frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor2(new Staffer.OrgChart.Layout.Size.$ctor1(10+random.next$1(150)|0,50+random.next$1(150)|0)))}},generateDataItems:function(dataSource,count){for(var item,$t=Bridge.getEnumerator(this.generateRandomDataItems(count),Staffer.OrgChart.Test.TestDataItem);$t.moveNext();)item=$t.getCurrent(),dataSource.items.add(item.getId(),item)},generateRandomDataItems:function(itemCount){var $t,$yield=[],random,items,i,firstInLayer,prevLayerSize,layerSize,i1,parentIndex,i2,i3,item;if(itemCount<0)throw new System.ArgumentOutOfRangeException("itemCount","Count must be zero or positive",null,itemCount);for(random=new System.Random.$ctor1(0),items=new(System.Collections.Generic.List$1(Staffer.OrgChart.Test.TestDataItem))(itemCount),i=0;i<itemCount;i=i+1|0)items.add(Bridge.merge(new Staffer.OrgChart.Test.TestDataItem,{setId:i.toString()}));for(firstInLayer=1,prevLayerSize=1;firstInLayer<itemCount;){for(layerSize=(5+prevLayerSize|0)+random.next$1(prevLayerSize*2|0)|0,i1=firstInLayer;i1<(firstInLayer+layerSize|0)&&i1<itemCount;i1=i1+1|0)parentIndex=(firstInLayer-1|0)-random.next$1(prevLayerSize)|0,items.getItem(i1).setParentId(items.getItem(parentIndex).getId());firstInLayer=firstInLayer+layerSize|0;prevLayerSize=layerSize}for(i2=0;i2<(Bridge.Int.div(items.getCount(),2)|0);i2=i2+1|0){var from=random.next$1(items.getCount()),to=random.next$1(items.getCount()),temp=items.getItem(from);items.setItem(from,items.getItem(to));items.setItem(to,temp)}for(i3=0;i3<Math.max(1,Bridge.Int.div(items.getCount(),10)|0);i3=i3+1|0)items.getItem(i3).setIsAssistant(!0);for($t=Bridge.getEnumerator(items);$t.moveNext();)item=$t.getCurrent(),$yield.push(item);return System.Array.toEnumerable($yield)}});Bridge.define("System.Diagnostics.DebuggerDisplayAttribute",{inherits:[System.Attribute],ctor:function(){this.$initialize();System.Attribute.ctor.call(this)}});Bridge.define("Staffer.OrgChart.Layout.BoxTree",{inherits:[Staffer.OrgChart.Misc.Tree$3(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)],statics:{build:function(source,getKeyFunc,getParentKeyFunc){for(var $t1,result=new Staffer.OrgChart.Layout.BoxTree(getParentKeyFunc,getKeyFunc),item,key,node,$t=Bridge.getEnumerator(source,Staffer.OrgChart.Layout.Box);$t.moveNext();){if(item=$t.getCurrent(),key=getKeyFunc(item),result.getNodes().containsKey(key))throw new System.Exception("Duplicate key: "+key);node=new(Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo))(item);result.getNodes().add(getKeyFunc(item),node)}for($t1=Bridge.getEnumerator(result.getNodes().getValues(),Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo));$t1.moveNext();)(function(){var node1=$t1.getCurrent(),parentKey=getParentKeyFunc(node1.getElement()),parentNode={};result.getNodes().tryGetValue(parentKey,parentNode)?node1.getElement().isAssistant&&parentNode.v.getElement().parentId!==Staffer.OrgChart.Layout.Box.None?parentNode.v.addAssistantChild(node1,function(){return Staffer.OrgChart.Layout.Box.special(Staffer.OrgChart.Layout.Box.None,parentNode.v.getElement().id,!0)}):parentNode.v.addRegularChild$1(node1):result.getRoots().add(node1)}).call(this);return result}},ctor:function(getParentKeyFunc,getKeyFunc){this.$initialize();Staffer.OrgChart.Misc.Tree$3(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo).ctor.call(this,getParentKeyFunc,getKeyFunc)}});Bridge.define("Staffer.OrgChart.Layout.FishboneAssistantsLayoutStrategy",{inherits:[Staffer.OrgChart.Layout.LayoutStrategyBase],preProcessThisNode:function(state,node){if(this.parentAlignment!==Staffer.OrgChart.Layout.BranchParentAlignment.Center)throw new System.InvalidOperationException("Unsupported value for ParentAlignment");if(node.getState().numberOfSiblings=node.getChildCount(),node.getState().numberOfSiblings>0){node.getState().numberOfSiblingColumns=1;node.getState().numberOfSiblingRows=Bridge.Int.div(node.getState().numberOfSiblings,2)|0;node.getState().numberOfSiblings%2!=0&&(node.getState().numberOfSiblingRows=node.getState().numberOfSiblingRows+1|0);var spacer=Staffer.OrgChart.Layout.Box.special(Staffer.OrgChart.Layout.Box.None,node.getElement().id,!1);node.addRegularChild(spacer)}},applyVerticalLayout:function(state,level){var node=level.branchRoot,prevRowBottom,maxOnLeft,i,rowExterior,i2;if(node.getLevel()===0)throw new System.InvalidOperationException("Should never be invoked on root node");for(prevRowBottom=node.getElement().frame.siblingsRowV.to,maxOnLeft=this.maxOnLeft(node),i=0;i<maxOnLeft;i=i+1|0){var child=System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),frame=child.getElement().frame,rect=frame.exterior;if(frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rect.getLeft(),prevRowBottom+this.parentChildSpacing,rect.size.width,rect.size.height),rowExterior=new Staffer.OrgChart.Layout.Dimensions.$ctor1(frame.exterior.getTop(),frame.exterior.getBottom()),i2=i+maxOnLeft|0,i2<node.getState().numberOfSiblings){var child2=System.Array.getItem(node.getChildren(),i2,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),frame2=child2.getElement().frame,rect2=child2.getElement().frame.exterior;frame2.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rect2.getLeft(),prevRowBottom+this.parentChildSpacing,rect2.size.width,rect2.size.height);frame2.exterior.getBottom()>frame.exterior.getBottom()?frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rect.getLeft(),frame2.exterior.getCenterV()-rect.size.height/2,rect.size.width,rect.size.height):frame2.exterior.getBottom()<frame.exterior.getBottom()&&(frame2.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rect2.getLeft(),frame.exterior.getCenterV()-rect2.size.height/2,rect2.size.width,rect2.size.height));frame2.branchExterior=frame2.exterior;rowExterior=Staffer.OrgChart.Layout.Dimensions.op_Addition(rowExterior,new Staffer.OrgChart.Layout.Dimensions.$ctor1(frame2.exterior.getTop(),frame2.exterior.getBottom()+state.getDiagram().getLayoutSettings().getBoxVerticalMargin()));frame2.siblingsRowV=rowExterior;Staffer.OrgChart.Layout.LayoutAlgorithm.verticalLayout(state,child2);prevRowBottom=frame2.branchExterior.getBottom()}frame.branchExterior=frame.exterior;frame.siblingsRowV=rowExterior;Staffer.OrgChart.Layout.LayoutAlgorithm.verticalLayout(state,child);prevRowBottom=Math.max(prevRowBottom,frame.branchExterior.getBottom())}},applyHorizontalLayout:function(state,level){var node=level.branchRoot,i,child,rightmost,k,opposite,spacer,rect,diff,carrier,desiredCenter;node.getLevel()===0&&(node.getElement().frame.siblingsRowV=new Staffer.OrgChart.Layout.Dimensions.$ctor1(node.getElement().frame.exterior.getTop(),node.getElement().frame.exterior.getBottom()));var left=!0,countOnThisSide=0,maxOnLeft=this.maxOnLeft(node);for(i=0;i<node.getState().numberOfSiblings;i=i+1|0)if(child=System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),Staffer.OrgChart.Layout.LayoutAlgorithm.horizontalLayout(state,child),(countOnThisSide=countOnThisSide+1|0)===maxOnLeft)if(left){for(Staffer.OrgChart.Layout.LayoutAlgorithm.alignHorizontalCenters(state,level,this.enumerateSiblings(node,0,maxOnLeft)),left=!1,countOnThisSide=0,rightmost=System.Double.min,k=0;k<=i;k=k+1|0)rightmost=Math.max(rightmost,System.Array.getItem(node.getChildren(),k,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.branchExterior.getRight());node.getState().numberOfSiblings%2!=0?rightmost=Math.max(rightmost,child.getElement().frame.exterior.getRight()):(opposite=System.Array.getItem(node.getChildren(),node.getState().numberOfSiblings-1|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),rightmost=opposite.getElement().isCollapsed||opposite.getChildCount()===0?Math.max(rightmost,child.getElement().frame.exterior.getRight()):Math.max(rightmost,child.getElement().frame.branchExterior.getRight()));spacer=System.Array.getItem(node.getChildren(),node.getState().numberOfSiblings,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement();spacer.frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rightmost,node.getElement().frame.exterior.getBottom(),state.getDiagram().getLayoutSettings().getBranchSpacing(),node.getElement().frame.branchExterior.getBottom()-node.getElement().frame.exterior.getBottom());spacer.frame.branchExterior=spacer.frame.exterior;level.boundary.mergeFrom$1(spacer)}else Staffer.OrgChart.Layout.LayoutAlgorithm.alignHorizontalCenters(state,level,this.enumerateSiblings(node,maxOnLeft,node.getState().numberOfSiblings));if(rect=node.getElement().frame.exterior,this.parentAlignment===Staffer.OrgChart.Layout.BranchParentAlignment.Center)node.getLevel()>0&&(carrier=System.Array.getItem(node.getChildren(),node.getState().numberOfSiblings,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getCenterH(),desiredCenter=rect.getCenterH(),diff=desiredCenter-carrier,Staffer.OrgChart.Layout.LayoutAlgorithm.moveChildrenOnly(state,level,diff));else throw new System.InvalidOperationException("Invalid ParentAlignment setting");},routeConnectors:function(state,node){var count=node.getState().numberOfSiblings,i,to,y;this.needCarrierProtector(node)&&(count=count+1|0);var segments=System.Array.init(count,function(){return new Staffer.OrgChart.Layout.Edge}),ix=0,maxOnLeft=this.maxOnLeft(node),carrier=System.Array.getItem(node.getChildren(),node.getState().numberOfSiblings,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior,from=carrier.getCenterH(),isLeft=!0,countOnThisSide=0,bottomMost=System.Double.min;for(i=0;i<count;i=i+1|0)to=isLeft?System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getRight():System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getLeft(),y=System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getCenterV(),bottomMost=Math.max(bottomMost,y),segments[Bridge.identity(ix,ix=ix+1|0)]=new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(from,y),new Staffer.OrgChart.Layout.Point.$ctor1(to,y)),(countOnThisSide=countOnThisSide+1|0)===maxOnLeft&&(countOnThisSide=0,isLeft=!isLeft);this.needCarrierProtector(node)&&(segments[node.getState().numberOfSiblings]=new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(carrier.getCenterH(),carrier.getTop()),new Staffer.OrgChart.Layout.Point.$ctor1(carrier.getCenterH(),bottomMost)));node.getElement().frame.connector=new Staffer.OrgChart.Layout.Connector(segments)},maxOnLeft:function(node){return(Bridge.Int.div(node.getState().numberOfSiblings,2)|0)+node.getState().numberOfSiblings%2|0},needCarrierProtector:function(node){return node.getParentNode().getChildCount()===0},enumerateSiblings:function(node,from,to){for(var $yield=[],i=from;i<to;i=i+1|0)$yield.push(System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)));return System.Array.toEnumerable($yield)}});Bridge.define("Staffer.OrgChart.Layout.LinearLayoutStrategy",{inherits:[Staffer.OrgChart.Layout.LayoutStrategyBase],preProcessThisNode:function(state,node){var verticalSpacer,horizontalSpacer;if(this.parentAlignment!==Staffer.OrgChart.Layout.BranchParentAlignment.Center)throw new System.InvalidOperationException("Unsupported value for alignment: "+System.Enum.toString(Staffer.OrgChart.Layout.BranchParentAlignment,this.parentAlignment));node.getChildCount()>0&&(node.getState().numberOfSiblings=node.getElement().isCollapsed?0:node.getChildCount(),node.getElement().isCollapsed||(verticalSpacer=Staffer.OrgChart.Layout.Box.special(Staffer.OrgChart.Layout.Box.None,node.getElement().id,!1),node.addRegularChild(verticalSpacer),horizontalSpacer=Staffer.OrgChart.Layout.Box.special(Staffer.OrgChart.Layout.Box.None,node.getElement().id,!1),node.addRegularChild(horizontalSpacer)))},applyVerticalLayout:function(state,level){var node=level.branchRoot,siblingsRowExterior,top,i,child,rect,i1,child1;if(node.getLevel()===0&&(node.getElement().frame.siblingsRowV=new Staffer.OrgChart.Layout.Dimensions.$ctor1(node.getElement().frame.exterior.getTop(),node.getElement().frame.exterior.getBottom())),node.getAssistantsRoot()!=null&&(node.getAssistantsRoot().getElement().frame.copyExteriorFrom(node.getElement().frame),Staffer.OrgChart.Layout.LayoutAlgorithm.verticalLayout(state,node.getAssistantsRoot())),node.getState().numberOfSiblings!==0){for(siblingsRowExterior=Staffer.OrgChart.Layout.Dimensions.minMax(),top=node.getAssistantsRoot()==null?node.getElement().frame.siblingsRowV.to+this.parentChildSpacing:node.getElement().frame.branchExterior.getBottom()+this.parentChildSpacing,i=0;i<node.getState().numberOfSiblings;i=i+1|0)child=System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),rect=child.getElement().frame.exterior,child.getElement().frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rect.getLeft(),top,rect.size.width,rect.size.height),child.getElement().frame.branchExterior=child.getElement().frame.exterior,siblingsRowExterior=Staffer.OrgChart.Layout.Dimensions.op_Addition(siblingsRowExterior,new Staffer.OrgChart.Layout.Dimensions.$ctor1(top,top+rect.size.height));for(siblingsRowExterior=new Staffer.OrgChart.Layout.Dimensions.$ctor1(siblingsRowExterior.from,siblingsRowExterior.to+state.getDiagram().getLayoutSettings().getBoxVerticalMargin()),i1=0;i1<node.getState().numberOfSiblings;i1=i1+1|0)child1=System.Array.getItem(node.getChildren(),i1,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),child1.getElement().frame.siblingsRowV=siblingsRowExterior,Staffer.OrgChart.Layout.LayoutAlgorithm.verticalLayout(state,child1)}},applyHorizontalLayout:function(state,level){var node=level.branchRoot,i,child,verticalSpacerBox,firstInRow,horizontalSpacerBox;for(node.getAssistantsRoot()!=null&&Staffer.OrgChart.Layout.LayoutAlgorithm.horizontalLayout(state,node.getAssistantsRoot()),i=0;i<node.getState().numberOfSiblings;i=i+1|0)child=System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),Staffer.OrgChart.Layout.LayoutAlgorithm.horizontalLayout(state,child);if(this.parentAlignment!==Staffer.OrgChart.Layout.BranchParentAlignment.Center)throw new System.InvalidOperationException("Unsupported ParentAlignment setting: "+System.Enum.toString(Staffer.OrgChart.Layout.BranchParentAlignment,this.parentAlignment));if(node.getLevel()>0&&node.getChildCount()>0){var rect=node.getElement().frame.exterior,leftmost=System.Array.getItem(node.getChildren(),0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getCenterH(),rightmost=System.Array.getItem(node.getChildren(),node.getState().numberOfSiblings-1|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getCenterH(),desiredCenter=leftmost+(rightmost-leftmost)/2,center=rect.getCenterH(),diff=center-desiredCenter;Staffer.OrgChart.Layout.LayoutAlgorithm.moveChildrenOnly(state,level,diff);verticalSpacerBox=System.Array.getItem(node.getChildren(),node.getState().numberOfSiblings,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement();verticalSpacerBox.frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(center-this.parentConnectorShield/2,rect.getBottom(),this.parentConnectorShield,System.Array.getItem(node.getChildren(),0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.siblingsRowV.from-rect.getBottom());verticalSpacerBox.frame.branchExterior=verticalSpacerBox.frame.exterior;state.mergeSpacer(verticalSpacerBox);firstInRow=System.Array.getItem(node.getChildren(),0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame;horizontalSpacerBox=System.Array.getItem(node.getChildren(),node.getState().numberOfSiblings+1|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement();horizontalSpacerBox.frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(firstInRow.exterior.getLeft(),firstInRow.siblingsRowV.from-this.parentChildSpacing,System.Array.getItem(node.getChildren(),node.getState().numberOfSiblings-1|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getRight()-firstInRow.exterior.getLeft(),this.parentChildSpacing);horizontalSpacerBox.frame.branchExterior=horizontalSpacerBox.frame.exterior;state.mergeSpacer(horizontalSpacerBox)}},routeConnectors:function(state,node){var normalChildCount=node.getState().numberOfSiblings,count=normalChildCount===0?0:normalChildCount===1?1:2+normalChildCount|0,space,i,childRect,childCenter;if(count===0){node.getElement().frame.connector=null;return}var segments=System.Array.init(count,function(){return new Staffer.OrgChart.Layout.Edge}),rootRect=node.getElement().frame.exterior,center=rootRect.getCenterH();if(node.getChildren()==null)throw new System.Exception("State is present, but children not set");if(count===1)segments[0]=new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(center,rootRect.getBottom()),new Staffer.OrgChart.Layout.Point.$ctor1(center,System.Array.getItem(node.getChildren(),0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getTop()));else{for(space=System.Array.getItem(node.getChildren(),0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.siblingsRowV.from-rootRect.getBottom(),segments[0]=new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(center,rootRect.getBottom()),new Staffer.OrgChart.Layout.Point.$ctor1(center,rootRect.getBottom()+space-this.childConnectorHookLength)),i=0;i<normalChildCount;i=i+1|0)childRect=System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior,childCenter=childRect.getCenterH(),segments[1+i|0]=new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(childCenter,childRect.getTop()),new Staffer.OrgChart.Layout.Point.$ctor1(childCenter,childRect.getTop()-this.childConnectorHookLength));segments[count-1|0]=new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(segments[1].to.x,segments[1].to.y),new Staffer.OrgChart.Layout.Point.$ctor1(segments[count-2|0].to.x,segments[1].to.y))}node.getElement().frame.connector=new Staffer.OrgChart.Layout.Connector(segments)}});Bridge.define("Staffer.OrgChart.Layout.MultiLineFishboneLayoutStrategy.SingleFishboneLayoutAdapter",{inherits:[Staffer.OrgChart.Layout.LayoutStrategyBase],realRoot:null,specialRoot:null,iterator:null,ctor:function(realRoot){this.$initialize();Staffer.OrgChart.Layout.LayoutStrategyBase.ctor.call(this);this.iterator=new Staffer.OrgChart.Layout.MultiLineFishboneLayoutStrategy.SingleFishboneLayoutAdapter.GroupIterator(realRoot.getState().numberOfSiblings,realRoot.getState().numberOfSiblingColumns);this.realRoot=realRoot;this.specialRoot=Bridge.merge(new Staffer.OrgChart.Layout.MultiLineFishboneLayoutStrategy.SingleFishboneLayoutAdapter.TreeNodeView(Staffer.OrgChart.Layout.Box.special(Staffer.OrgChart.Layout.Box.None,realRoot.getElement().id,!0)),{setLevel:this.realRoot.getLevel(),setParentNode:this.realRoot});this.specialRoot.getState().setEffectiveLayoutStrategy(this);var parentStrategy=Bridge.cast(realRoot.getState().requireLayoutStrategy(),Staffer.OrgChart.Layout.MultiLineFishboneLayoutStrategy);this.siblingSpacing=parentStrategy.siblingSpacing;this.parentConnectorShield=parentStrategy.parentConnectorShield;this.parentChildSpacing=parentStrategy.parentChildSpacing;this.parentAlignment=parentStrategy.parentAlignment;this.childConnectorHookLength=parentStrategy.childConnectorHookLength},nextGroup:function(){var i,spacer;if(!this.iterator.nextGroup())return!1;for(this.specialRoot.getState().numberOfSiblings=this.iterator.count,this.specialRoot.prepare(this.realRoot.getState().numberOfSiblingRows*2|0),i=0;i<this.iterator.count;i=i+1|0)this.specialRoot.addChildView(System.Array.getItem(this.realRoot.getChildren(),this.iterator.fromIndex+i|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)));return spacer=System.Array.getItem(this.realRoot.getChildren(),(this.realRoot.getState().numberOfSiblings+1|0)+this.iterator.group|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),this.specialRoot.addChildView(spacer),this.specialRoot.getElement().frame.copyExteriorFrom(this.realRoot.getElement().frame),!0},preProcessThisNode:function(){throw new System.NotSupportedException;},applyVerticalLayout:function(state){for(var rowExterior,i2,prevRowBottom=this.realRoot.getAssistantsRoot()==null?this.specialRoot.getElement().frame.siblingsRowV.to:this.realRoot.getAssistantsRoot().getElement().frame.branchExterior.getBottom(),i=0;i<this.iterator.maxOnLeft;i=i+1|0){var child=System.Array.getItem(this.specialRoot.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),frame=child.getElement().frame,rect=frame.exterior;if(frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rect.getLeft(),prevRowBottom+this.parentChildSpacing,rect.size.width,rect.size.height),rowExterior=new Staffer.OrgChart.Layout.Dimensions.$ctor1(frame.exterior.getTop(),frame.exterior.getBottom()),i2=i+this.iterator.maxOnLeft|0,i2<this.iterator.count){var child2=System.Array.getItem(this.specialRoot.getChildren(),i2,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),frame2=child2.getElement().frame,rect2=child2.getElement().frame.exterior;frame2.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rect2.getLeft(),prevRowBottom+this.parentChildSpacing,rect2.size.width,rect2.size.height);frame2.exterior.getBottom()>frame.exterior.getBottom()?frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rect.getLeft(),frame2.exterior.getCenterV()-rect.size.height/2,rect.size.width,rect.size.height):frame2.exterior.getBottom()<frame.exterior.getBottom()&&(frame2.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rect2.getLeft(),frame.exterior.getCenterV()-rect2.size.height/2,rect2.size.width,rect2.size.height));frame2.branchExterior=frame2.exterior;rowExterior=Staffer.OrgChart.Layout.Dimensions.op_Addition(rowExterior,new Staffer.OrgChart.Layout.Dimensions.$ctor1(frame2.exterior.getTop(),frame2.exterior.getBottom()+state.getDiagram().getLayoutSettings().getBoxVerticalMargin()));frame2.siblingsRowV=rowExterior;Staffer.OrgChart.Layout.LayoutAlgorithm.verticalLayout(state,child2);prevRowBottom=frame2.branchExterior.getBottom()}frame.branchExterior=frame.exterior;frame.siblingsRowV=rowExterior;Staffer.OrgChart.Layout.LayoutAlgorithm.verticalLayout(state,child);prevRowBottom=Math.max(prevRowBottom,frame.branchExterior.getBottom())}},applyHorizontalLayout:function(state,level){var left,countOnThisSide,i,child,rightmost,k,opposite,spacer;if(!Bridge.referenceEquals(level.branchRoot,this.specialRoot))throw new System.InvalidOperationException("Wrong root node received");for(left=!0,countOnThisSide=0,i=0;i<this.iterator.count;i=i+1|0)if(child=System.Array.getItem(this.specialRoot.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),Staffer.OrgChart.Layout.LayoutAlgorithm.horizontalLayout(state,child),(countOnThisSide=countOnThisSide+1|0)===this.iterator.maxOnLeft)if(left){for(Staffer.OrgChart.Layout.LayoutAlgorithm.alignHorizontalCenters(state,level,this.enumerateSiblings(0,this.iterator.maxOnLeft)),left=!1,countOnThisSide=0,rightmost=System.Double.min,k=0;k<=i;k=k+1|0)rightmost=Math.max(rightmost,System.Array.getItem(this.specialRoot.getChildren(),k,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.branchExterior.getRight());this.iterator.count%2!=0?rightmost=Math.max(rightmost,child.getElement().frame.exterior.getRight()):(opposite=System.Array.getItem(this.specialRoot.getChildren(),this.specialRoot.getState().numberOfSiblings-1|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),rightmost=opposite.getElement().isCollapsed||opposite.getChildCount()===0?Math.max(rightmost,child.getElement().frame.exterior.getRight()):Math.max(rightmost,child.getElement().frame.branchExterior.getRight()));spacer=System.Array.getItem(this.specialRoot.getChildren(),this.specialRoot.getState().numberOfSiblings,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement();spacer.frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rightmost,System.Array.getItem(this.specialRoot.getChildren(),0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.siblingsRowV.from,this.siblingSpacing,child.getElement().frame.siblingsRowV.to-System.Array.getItem(this.specialRoot.getChildren(),0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.siblingsRowV.from);spacer.frame.branchExterior=spacer.frame.exterior;level.boundary.mergeFrom$1(spacer)}else Staffer.OrgChart.Layout.LayoutAlgorithm.alignHorizontalCenters(state,level,this.enumerateSiblings(this.iterator.maxOnLeft,this.iterator.count))},enumerateSiblings:function(from,to){for(var $yield=[],i=from;i<to;i=i+1|0)$yield.push(System.Array.getItem(this.specialRoot.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)));return System.Array.toEnumerable($yield)},routeConnectors:function(){throw new System.NotSupportedException;}});Bridge.define("Staffer.OrgChart.Layout.MultiLineFishboneLayoutStrategy.SingleFishboneLayoutAdapter.TreeNodeView",{inherits:[Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)],ctor:function(element){this.$initialize();Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo).ctor.call(this,element)},prepare:function(capacity){this.getChildren()==null?this.setChildren(new(System.Collections.Generic.List$1(Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)))(capacity)):System.Array.clear(this.getChildren(),Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo))},addChildView:function(node){System.Array.add(this.getChildren(),node,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo))}});Bridge.define("Staffer.OrgChart.Layout.SingleColumnLayoutStrategy",{inherits:[Staffer.OrgChart.Layout.LayoutStrategyBase],preProcessThisNode:function(state,node){if(this.parentAlignment!==Staffer.OrgChart.Layout.BranchParentAlignment.Left&&this.parentAlignment!==Staffer.OrgChart.Layout.BranchParentAlignment.Right)throw new System.InvalidOperationException("Unsupported value for ParentAlignment");if(node.getState().numberOfSiblings=node.getElement().isCollapsed?0:node.getChildCount(),node.getState().numberOfSiblings>0&&node.getLevel()>0){node.getState().numberOfSiblingColumns=1;node.getState().numberOfSiblingRows=node.getChildCount();var verticalSpacer=Staffer.OrgChart.Layout.Box.special(Staffer.OrgChart.Layout.Box.None,node.getElement().id,!1);node.addRegularChild(verticalSpacer)}},applyVerticalLayout:function(state,level){var node=level.branchRoot,prevRowExterior,row,rowExterior,childBranchBottom;for(node.getLevel()===0&&(node.getElement().frame.siblingsRowV=new Staffer.OrgChart.Layout.Dimensions.$ctor1(node.getElement().frame.exterior.getTop(),node.getElement().frame.exterior.getBottom())),node.getAssistantsRoot()!=null&&(node.getAssistantsRoot().getElement().frame.copyExteriorFrom(node.getElement().frame),Staffer.OrgChart.Layout.LayoutAlgorithm.verticalLayout(state,node.getAssistantsRoot())),prevRowExterior=new Staffer.OrgChart.Layout.Dimensions.$ctor1(node.getElement().frame.siblingsRowV.from,node.getAssistantsRoot()==null?node.getElement().frame.siblingsRowV.to:node.getElement().frame.branchExterior.getBottom()),row=0;row<node.getState().numberOfSiblings;row=row+1|0){var child=System.Array.getItem(node.getChildren(),row,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),rect=child.getElement().frame.exterior,top=prevRowExterior.to+this.parentChildSpacing;child.getElement().frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rect.getLeft(),top,rect.size.width,rect.size.height);child.getElement().frame.branchExterior=child.getElement().frame.exterior;rowExterior=new Staffer.OrgChart.Layout.Dimensions.$ctor1(top,top+rect.size.height);child=System.Array.getItem(node.getChildren(),row,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo));child.getElement().frame.siblingsRowV=rowExterior;Staffer.OrgChart.Layout.LayoutAlgorithm.verticalLayout(state,child);childBranchBottom=child.getElement().frame.branchExterior.getBottom();prevRowExterior=new Staffer.OrgChart.Layout.Dimensions.$ctor1(rowExterior.from,Math.max(childBranchBottom,rowExterior.to))}},applyHorizontalLayout:function(state,level){var node=level.branchRoot,nodeState=node.getState(),row,child,edges,rect,diff,desiredLeft,desiredRight,verticalSpacerBox,spacerTop,spacerBottom;for(node.getAssistantsRoot()!=null&&Staffer.OrgChart.Layout.LayoutAlgorithm.horizontalLayout(state,node.getAssistantsRoot()),row=0;row<nodeState.numberOfSiblings;row=row+1|0)child=System.Array.getItem(node.getChildren(),row,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),Staffer.OrgChart.Layout.LayoutAlgorithm.horizontalLayout(state,child);if(edges=Staffer.OrgChart.Layout.LayoutAlgorithm.alignHorizontalCenters(state,level,this.enumerateColumn(node)),node.getLevel()>0&&node.getChildCount()>0){if(rect=node.getElement().frame.exterior,this.parentAlignment===Staffer.OrgChart.Layout.BranchParentAlignment.Left)desiredLeft=rect.getCenterH()+this.parentConnectorShield/2,diff=desiredLeft-edges.from;else if(this.parentAlignment===Staffer.OrgChart.Layout.BranchParentAlignment.Right)desiredRight=rect.getCenterH()-this.parentConnectorShield/2,diff=desiredRight-edges.to;else throw new System.InvalidOperationException("Invalid ParentAlignment setting");Staffer.OrgChart.Layout.LayoutAlgorithm.moveChildrenOnly(state,level,diff);verticalSpacerBox=node.getLevel()>0?System.Array.getItem(node.getChildren(),node.getChildCount()-1|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement():null;verticalSpacerBox!=null&&(spacerTop=node.getElement().frame.exterior.getBottom(),spacerBottom=System.Array.getItem(node.getChildren(),node.getChildCount()-2|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getBottom(),verticalSpacerBox.frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rect.getCenterH()-this.parentConnectorShield/2,spacerTop,this.parentConnectorShield,spacerBottom-spacerTop),verticalSpacerBox.frame.branchExterior=verticalSpacerBox.frame.exterior,state.mergeSpacer(verticalSpacerBox))}},enumerateColumn:function(branchRoot){for(var $yield=[],i=0;i<branchRoot.getState().numberOfSiblings;i=i+1|0)$yield.push(System.Array.getItem(branchRoot.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)));return System.Array.toEnumerable($yield)},routeConnectors:function(state,node){var ix,rect,destination;if(node.getChildCount()!==0){var count=1+node.getState().numberOfSiblings|0,segments=System.Array.init(count,function(){return new Staffer.OrgChart.Layout.Edge}),rootRect=node.getElement().frame.exterior,center=rootRect.getCenterH(),verticalCarrierHeight=System.Array.getItem(node.getChildren(),node.getState().numberOfSiblings-1|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getCenterV()-node.getElement().frame.exterior.getBottom();for(segments[0]=new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(center,rootRect.getBottom()),new Staffer.OrgChart.Layout.Point.$ctor1(center,rootRect.getBottom()+verticalCarrierHeight)),ix=0;ix<node.getState().numberOfSiblings;ix=ix+1|0)rect=System.Array.getItem(node.getChildren(),ix,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior,destination=this.parentAlignment===Staffer.OrgChart.Layout.BranchParentAlignment.Left?rect.getLeft():rect.getRight(),segments[1+ix|0]=new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(center,rect.getCenterV()),new Staffer.OrgChart.Layout.Point.$ctor1(destination,rect.getCenterV()));node.getElement().frame.connector=new Staffer.OrgChart.Layout.Connector(segments)}}});Bridge.define("Staffer.OrgChart.Test.TestDataItem",{inherits:[Staffer.OrgChart.Layout.IChartDataItem],config:{properties:{Id:null,IsAssistant:!1,ParentId:null,String1:null,String2:null,Date1:null},alias:["getId","Staffer$OrgChart$Layout$IChartDataItem$getId","setId","Staffer$OrgChart$Layout$IChartDataItem$setId","getIsAssistant","Staffer$OrgChart$Layout$IChartDataItem$getIsAssistant","setIsAssistant","Staffer$OrgChart$Layout$IChartDataItem$setIsAssistant"],init:function(){this.Date1=new Date(-864e13)}}});Bridge.define("Staffer.OrgChart.Test.TestDataSource",{inherits:[Staffer.OrgChart.Layout.IChartDataSource],items:null,config:{alias:["getAllDataItemIds","Staffer$OrgChart$Layout$IChartDataSource$getAllDataItemIds","getGetParentKeyFunc","Staffer$OrgChart$Layout$IChartDataSource$getGetParentKeyFunc","getGetDataItemFunc","Staffer$OrgChart$Layout$IChartDataSource$getGetDataItemFunc"],init:function(){this.items=new(System.Collections.Generic.Dictionary$2(String,Staffer.OrgChart.Test.TestDataItem))}},getAllDataItemIds:function(){return this.items.getKeys()},getGetParentKeyFunc:function(){return Bridge.fn.bind(this,this.getParentKey)},getGetDataItemFunc:function(){return Bridge.fn.bind(this,this.getDataItem)},getParentKey:function(itemId){return this.items.get(itemId).getParentId()},getDataItem:function(itemId){return this.items.get(itemId)}});Bridge.define("Staffer.OrgChart.Layout.MultiLineFishboneLayoutStrategy",{inherits:[Staffer.OrgChart.Layout.LinearLayoutStrategy],maxGroups:4,preProcessThisNode:function(state,node){var parentSpacer,i,verticalSpacer,horizontalSpacer;if(this.parentAlignment!==Staffer.OrgChart.Layout.BranchParentAlignment.Center)throw new System.InvalidOperationException("Unsupported value for ParentAlignment");if(this.maxGroups<=0)throw new System.InvalidOperationException("MaxGroups must be a positive value");if(node.getChildCount()<=(this.maxGroups*2|0)){Staffer.OrgChart.Layout.LinearLayoutStrategy.prototype.preProcessThisNode.call(this,state,node);return}if(node.getState().numberOfSiblings=node.getChildCount(),node.getState().numberOfSiblings>0){for(node.getState().numberOfSiblingColumns=this.maxGroups,node.getState().numberOfSiblingRows=Bridge.Int.div(node.getState().numberOfSiblings,this.maxGroups*2|0)|0,node.getState().numberOfSiblings%(this.maxGroups*2|0)!=0&&(node.getState().numberOfSiblingRows=node.getState().numberOfSiblingRows+1|0),parentSpacer=Staffer.OrgChart.Layout.Box.special(Staffer.OrgChart.Layout.Box.None,node.getElement().id,!1),node.addRegularChild(parentSpacer),i=0;i<node.getState().numberOfSiblingColumns;i=i+1|0)verticalSpacer=Staffer.OrgChart.Layout.Box.special(Staffer.OrgChart.Layout.Box.None,node.getElement().id,!1),node.addRegularChild(verticalSpacer);node.getState().numberOfSiblingColumns>1&&(horizontalSpacer=Staffer.OrgChart.Layout.Box.special(Staffer.OrgChart.Layout.Box.None,node.getElement().id,!1),node.addRegularChild(horizontalSpacer))}},applyVerticalLayout:function(state,level){var node,adapter;if(level.branchRoot.getState().numberOfSiblings<=(this.maxGroups*2|0)){Staffer.OrgChart.Layout.LinearLayoutStrategy.prototype.applyVerticalLayout.call(this,state,level);return}for(node=level.branchRoot,node.getLevel()===0&&(node.getElement().frame.siblingsRowV=new Staffer.OrgChart.Layout.Dimensions.$ctor1(node.getElement().frame.exterior.getTop(),node.getElement().frame.exterior.getBottom())),node.getAssistantsRoot()!=null&&(node.getAssistantsRoot().getElement().frame.copyExteriorFrom(node.getElement().frame),Staffer.OrgChart.Layout.LayoutAlgorithm.verticalLayout(state,node.getAssistantsRoot())),adapter=new Staffer.OrgChart.Layout.MultiLineFishboneLayoutStrategy.SingleFishboneLayoutAdapter(node);adapter.nextGroup();)Staffer.OrgChart.Layout.LayoutAlgorithm.verticalLayout(state,adapter.specialRoot)},applyHorizontalLayout:function(state,level){var node,adapter,rect,diff,carrier,desiredCenter1,ix,verticalSpacerBox;if(level.branchRoot.getState().numberOfSiblings<=(this.maxGroups*2|0)){Staffer.OrgChart.Layout.LinearLayoutStrategy.prototype.applyHorizontalLayout.call(this,state,level);return}for(node=level.branchRoot,node.getLevel()===0&&(node.getElement().frame.siblingsRowV=new Staffer.OrgChart.Layout.Dimensions.$ctor1(node.getElement().frame.exterior.getTop(),node.getElement().frame.exterior.getBottom())),node.getAssistantsRoot()!=null&&Staffer.OrgChart.Layout.LayoutAlgorithm.horizontalLayout(state,node.getAssistantsRoot()),adapter=new Staffer.OrgChart.Layout.MultiLineFishboneLayoutStrategy.SingleFishboneLayoutAdapter(node);adapter.nextGroup();)Staffer.OrgChart.Layout.LayoutAlgorithm.horizontalLayout(state,adapter.specialRoot);if(rect=node.getElement().frame.exterior,this.parentAlignment===Staffer.OrgChart.Layout.BranchParentAlignment.Center){if(node.getLevel()>0){if(node.getState().numberOfSiblingColumns>1){var leftCarrier=System.Array.getItem(node.getChildren(),node.getState().numberOfSiblings+1|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getCenterH(),rightCarrier=System.Array.getItem(node.getChildren(),node.getState().numberOfSiblings+node.getState().numberOfSiblingColumns|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getCenterH(),desiredCenter=(leftCarrier+rightCarrier)/2;diff=rect.getCenterH()-desiredCenter}else carrier=System.Array.getItem(node.getChildren(),1+node.getState().numberOfSiblings|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getCenterH(),desiredCenter1=rect.getCenterH(),diff=desiredCenter1-carrier;Staffer.OrgChart.Layout.LayoutAlgorithm.moveChildrenOnly(state,level,diff)}}else throw new System.InvalidOperationException("Invalid ParentAlignment setting");if(node.getLevel()>0&&(ix=node.getState().numberOfSiblings,verticalSpacerBox=System.Array.getItem(node.getChildren(),ix,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement(),verticalSpacerBox.frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rect.getCenterH()-this.parentConnectorShield/2,rect.getBottom(),this.parentConnectorShield,System.Array.getItem(node.getChildren(),0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.siblingsRowV.from-rect.getBottom()),verticalSpacerBox.frame.branchExterior=verticalSpacerBox.frame.exterior,state.mergeSpacer(verticalSpacerBox),ix=ix+1|0,ix=ix+node.getState().numberOfSiblingColumns|0,node.getState().numberOfSiblingColumns>1)){var horizontalSpacerBox=System.Array.getItem(node.getChildren(),ix,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement(),leftmost=System.Array.getItem(node.getChildren(),node.getState().numberOfSiblings+1|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.topLeft,rightmost=System.Array.getItem(node.getChildren(),ix-1|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getRight();horizontalSpacerBox.frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(leftmost.x,leftmost.y-this.parentChildSpacing,rightmost-leftmost.x,this.parentChildSpacing);horizontalSpacerBox.frame.branchExterior=horizontalSpacerBox.frame.exterior;state.mergeSpacer(horizontalSpacerBox)}},routeConnectors:function(state,node){var count,iterator,i,to,y,leftGroup,rightGroup;if(node.getState().numberOfSiblings<=(this.maxGroups*2|0)){Staffer.OrgChart.Layout.LinearLayoutStrategy.prototype.routeConnectors.call(this,state,node);return}count=(1+node.getState().numberOfSiblings|0)+node.getState().numberOfSiblingColumns|0;node.getState().numberOfSiblingColumns>1&&(count=count+1|0);var segments=System.Array.init(count,function(){return new Staffer.OrgChart.Layout.Edge}),rootRect=node.getElement().frame.exterior,center=rootRect.getCenterH(),ix=0,space=System.Array.getItem(node.getChildren(),0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.siblingsRowV.from-rootRect.getBottom();for(segments[Bridge.identity(ix,ix=ix+1|0)]=new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(center,rootRect.getBottom()),new Staffer.OrgChart.Layout.Point.$ctor1(center,rootRect.getBottom()+space-this.childConnectorHookLength)),iterator=new Staffer.OrgChart.Layout.MultiLineFishboneLayoutStrategy.SingleFishboneLayoutAdapter.GroupIterator(node.getState().numberOfSiblings,node.getState().numberOfSiblingColumns);iterator.nextGroup();){var carrier=System.Array.getItem(node.getChildren(),(1+node.getState().numberOfSiblings|0)+iterator.group|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior,from=carrier.getCenterH(),isLeft=!0,countOnThisSide=0;for(i=iterator.fromIndex;i<(iterator.fromIndex+iterator.count|0);i=i+1|0)to=isLeft?System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getRight():System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getLeft(),y=System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getCenterV(),segments[Bridge.identity(ix,ix=ix+1|0)]=new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(from,y),new Staffer.OrgChart.Layout.Point.$ctor1(to,y)),(countOnThisSide=countOnThisSide+1|0)===iterator.maxOnLeft&&(countOnThisSide=0,isLeft&&(segments[(1+node.getState().numberOfSiblings|0)+iterator.group|0]=new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(carrier.getCenterH(),carrier.getTop()-this.childConnectorHookLength),new Staffer.OrgChart.Layout.Point.$ctor1(carrier.getCenterH(),System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior.getCenterV()))),isLeft=!isLeft)}ix=ix+node.getState().numberOfSiblingColumns|0;node.getState().numberOfSiblingColumns>1&&(leftGroup=System.Array.getItem(node.getChildren(),1+node.getState().numberOfSiblings|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior,rightGroup=System.Array.getItem(node.getChildren(),((1+node.getState().numberOfSiblings|0)+node.getState().numberOfSiblingColumns|0)-1|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.exterior,segments[ix]=new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(leftGroup.getCenterH(),leftGroup.getTop()-this.childConnectorHookLength),new Staffer.OrgChart.Layout.Point.$ctor1(rightGroup.getCenterH(),rightGroup.getTop()-this.childConnectorHookLength)));node.getElement().frame.connector=new Staffer.OrgChart.Layout.Connector(segments)}});Bridge.define("Staffer.OrgChart.Layout.MultiLineHangerLayoutStrategy",{inherits:[Staffer.OrgChart.Layout.LinearLayoutStrategy],maxSiblingsPerRow:4,preProcessThisNode:function(state,node){var lastRowBoxCount,ix,siblingSpacer,verticalSpacer,i,horizontalSpacer;if(this.parentAlignment!==Staffer.OrgChart.Layout.BranchParentAlignment.Center)throw new System.InvalidOperationException("Unsupported value for ParentAlignment");if(this.maxSiblingsPerRow<=0||this.maxSiblingsPerRow%2!=0)throw new System.InvalidOperationException("MaxSiblingsPerRow must be a positive even value");if(node.getChildCount()<=this.maxSiblingsPerRow){Staffer.OrgChart.Layout.LinearLayoutStrategy.prototype.preProcessThisNode.call(this,state,node);return}if(node.getState().numberOfSiblings=node.getChildCount(),node.getState().numberOfSiblings>0){for(lastRowBoxCount=node.getChildCount()%this.maxSiblingsPerRow,node.getState().numberOfSiblingColumns=1+this.maxSiblingsPerRow|0,node.getState().numberOfSiblingRows=Bridge.Int.div(node.getChildCount(),this.maxSiblingsPerRow)|0,lastRowBoxCount!==0&&(node.getState().numberOfSiblingRows=node.getState().numberOfSiblingRows+1|0),node.getState().numberOfSiblings=node.getChildCount()+node.getState().numberOfSiblingRows|0,lastRowBoxCount>0&&lastRowBoxCount<=(Bridge.Int.div(this.maxSiblingsPerRow,2)|0)&&(node.getState().numberOfSiblings=node.getState().numberOfSiblings-1|0),ix=Bridge.Int.div(this.maxSiblingsPerRow,2)|0;ix<node.getState().numberOfSiblings;)siblingSpacer=Staffer.OrgChart.Layout.Box.special(Staffer.OrgChart.Layout.Box.None,node.getElement().id,!1),node.insertRegularChild(ix,siblingSpacer),ix=ix+node.getState().numberOfSiblingColumns|0;for(verticalSpacer=Staffer.OrgChart.Layout.Box.special(Staffer.OrgChart.Layout.Box.None,node.getElement().id,!1),node.addRegularChild(verticalSpacer),i=0;i<node.getState().numberOfSiblingRows;i=i+1|0)horizontalSpacer=Staffer.OrgChart.Layout.Box.special(Staffer.OrgChart.Layout.Box.None,node.getElement().id,!1),node.addRegularChild(horizontalSpacer)}},applyVerticalLayout:function(state,level){var node=level.branchRoot,prevRowExterior,row,i,child,rect,top,siblingsBottom,i1,child1,spacerIndex,frame;if(node.getState().numberOfSiblings<=this.maxSiblingsPerRow){Staffer.OrgChart.Layout.LinearLayoutStrategy.prototype.applyVerticalLayout.call(this,state,level);return}for(node.getLevel()===0&&(node.getElement().frame.siblingsRowV=new Staffer.OrgChart.Layout.Dimensions.$ctor1(node.getElement().frame.exterior.getTop(),node.getElement().frame.exterior.getBottom())),node.getAssistantsRoot()!=null&&(node.getAssistantsRoot().getElement().frame.copyExteriorFrom(node.getElement().frame),Staffer.OrgChart.Layout.LayoutAlgorithm.verticalLayout(state,node.getAssistantsRoot())),prevRowExterior=new Staffer.OrgChart.Layout.Dimensions.$ctor1(node.getElement().frame.siblingsRowV.from,node.getAssistantsRoot()==null?node.getElement().frame.siblingsRowV.to:node.getElement().frame.branchExterior.getBottom()),row=0;row<node.getState().numberOfSiblingRows;row=row+1|0){var siblingsRowExterior=Staffer.OrgChart.Layout.Dimensions.minMax(),from=row*node.getState().numberOfSiblingColumns|0,to=Math.min(from+node.getState().numberOfSiblingColumns|0,node.getState().numberOfSiblings);for(i=from;i<to;i=i+1|0)(child=System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),child.getElement().isSpecial)||(rect=child.getElement().frame.exterior,top=prevRowExterior.to+this.parentChildSpacing,child.getElement().frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rect.getLeft(),top,rect.size.width,rect.size.height),child.getElement().frame.branchExterior=child.getElement().frame.exterior,siblingsRowExterior=Staffer.OrgChart.Layout.Dimensions.op_Addition(siblingsRowExterior,new Staffer.OrgChart.Layout.Dimensions.$ctor1(top,top+rect.size.height)));for(siblingsRowExterior=new Staffer.OrgChart.Layout.Dimensions.$ctor1(siblingsRowExterior.from,siblingsRowExterior.to+state.getDiagram().getLayoutSettings().getBoxVerticalMargin()),siblingsBottom=System.Double.min,i1=from;i1<to;i1=i1+1|0)child1=System.Array.getItem(node.getChildren(),i1,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),child1.getElement().frame.siblingsRowV=siblingsRowExterior,Staffer.OrgChart.Layout.LayoutAlgorithm.verticalLayout(state,child1),siblingsBottom=Math.max(siblingsBottom,child1.getElement().frame.branchExterior.getBottom());prevRowExterior=new Staffer.OrgChart.Layout.Dimensions.$ctor1(siblingsRowExterior.from,Math.max(siblingsBottom,siblingsRowExterior.to));spacerIndex=from+(Bridge.Int.div(node.getState().numberOfSiblingColumns,2)|0)|0;spacerIndex<node.getState().numberOfSiblings&&(frame=System.Array.getItem(node.getChildren(),spacerIndex,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame,frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(0,prevRowExterior.from,this.parentConnectorShield,prevRowExterior.to-prevRowExterior.from),frame.branchExterior=frame.exterior)}},applyHorizontalLayout:function(state,level){var node=level.branchRoot,col,row,ix,child,verticalSpacerBox,firstInRowIndex;if(node.getState().numberOfSiblings<=this.maxSiblingsPerRow){Staffer.OrgChart.Layout.LinearLayoutStrategy.prototype.applyHorizontalLayout.call(this,state,level);return}for(node.getAssistantsRoot()!=null&&Staffer.OrgChart.Layout.LayoutAlgorithm.horizontalLayout(state,node.getAssistantsRoot()),col=0;col<node.getState().numberOfSiblingColumns;col=col+1|0){for(row=0;row<node.getState().numberOfSiblingRows;row=row+1|0){if(ix=(row*node.getState().numberOfSiblingColumns|0)+col|0,ix>=node.getState().numberOfSiblings)break;child=System.Array.getItem(node.getChildren(),ix,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo));Staffer.OrgChart.Layout.LayoutAlgorithm.horizontalLayout(state,child)}Staffer.OrgChart.Layout.LayoutAlgorithm.alignHorizontalCenters(state,level,this.enumerateColumn(node,col))}if(this.parentAlignment===Staffer.OrgChart.Layout.BranchParentAlignment.Center){var rect=node.getElement().frame.exterior,spacer=System.Array.getItem(node.getChildren(),Bridge.Int.div(node.getState().numberOfSiblingColumns,2)|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)),desiredCenter=spacer.getElement().frame.exterior.getCenterH(),diff=rect.getCenterH()-desiredCenter;for(Staffer.OrgChart.Layout.LayoutAlgorithm.moveChildrenOnly(state,level,diff),verticalSpacerBox=System.Array.getItem(node.getChildren(),node.getState().numberOfSiblings,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement(),verticalSpacerBox.frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor3(rect.getCenterH()-this.parentConnectorShield/2,rect.getBottom(),this.parentConnectorShield,System.Array.getItem(node.getChildren(),0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.siblingsRowV.from-rect.getBottom()),verticalSpacerBox.frame.branchExterior=verticalSpacerBox.frame.exterior,state.mergeSpacer(verticalSpacerBox),firstInRowIndex=0;firstInRowIndex<node.getState().numberOfSiblings;firstInRowIndex=firstInRowIndex+node.getState().numberOfSiblingColumns|0){var firstInRow=System.Array.getItem(node.getChildren(),firstInRowIndex,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame,lastInRow=System.Array.getItem(node.getChildren(),Math.min((firstInRowIndex+node.getState().numberOfSiblingColumns|0)-1|0,node.getState().numberOfSiblings-1|0),Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame,horizontalSpacerBox=System.Array.getItem(node.getChildren(),(1+node.getState().numberOfSiblings|0)+(Bridge.Int.div(firstInRowIndex,node.getState().numberOfSiblingColumns)|0)|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement(),r=new Staffer.OrgChart.Layout.Rect.$ctor3(firstInRow.exterior.getLeft(),firstInRow.siblingsRowV.from-this.parentChildSpacing,lastInRow.exterior.getRight()-firstInRow.exterior.getLeft(),this.parentChildSpacing);horizontalSpacerBox.frame.exterior=r;r.getRight()<verticalSpacerBox.frame.exterior.getRight()&&(horizontalSpacerBox.frame.exterior=new Staffer.OrgChart.Layout.Rect.$ctor1(r.topLeft,new Staffer.OrgChart.Layout.Size.$ctor1(verticalSpacerBox.frame.exterior.getRight()-r.getLeft(),r.size.height)));horizontalSpacerBox.frame.branchExterior=horizontalSpacerBox.frame.exterior;state.mergeSpacer(horizontalSpacerBox)}}else throw new System.InvalidOperationException("Invalid ParentAlignment setting");},enumerateColumn:function(branchRoot,col){for(var ix,$yield=[],row=0;row<branchRoot.getState().numberOfSiblingRows;row=row+1|0){if(ix=(row*branchRoot.getState().numberOfSiblingColumns|0)+col|0,ix>=branchRoot.getState().numberOfSiblings)break;$yield.push(System.Array.getItem(branchRoot.getChildren(),ix,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)))}return System.Array.toEnumerable($yield)},routeConnectors:function(state,node){var $t,count,child,ix,i,child1,childRect,childCenter,lastChildHookIndex,firstInRowIndex,firstInRow,lastInRow;if(node.getState().numberOfSiblings<=this.maxSiblingsPerRow){Staffer.OrgChart.Layout.LinearLayoutStrategy.prototype.routeConnectors.call(this,state,node);return}for(count=1+node.getState().numberOfSiblingRows|0,$t=Bridge.getEnumerator(node.getChildren(),Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo));$t.moveNext();)child=$t.getCurrent(),child.getElement().isSpecial||(count=count+1|0);var segments=System.Array.init(count,function(){return new Staffer.OrgChart.Layout.Edge}),rootRect=node.getElement().frame.exterior,center=rootRect.getCenterH(),verticalCarrierHeight=System.Array.getItem(node.getChildren(),node.getState().numberOfSiblings-1|0,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement().frame.siblingsRowV.from-this.childConnectorHookLength-rootRect.getBottom();for(segments[0]=new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(center,rootRect.getBottom()),new Staffer.OrgChart.Layout.Point.$ctor1(center,rootRect.getBottom()+verticalCarrierHeight)),ix=1,i=0;i<node.getState().numberOfSiblings;i=i+1|0)child1=System.Array.getItem(node.getChildren(),i,Staffer.OrgChart.Misc.Tree$3.TreeNode(System.Int32,Staffer.OrgChart.Layout.Box,Staffer.OrgChart.Layout.NodeLayoutInfo)).getElement(),child1.isSpecial||(childRect=child1.frame.exterior,childCenter=childRect.getCenterH(),segments[Bridge.identity(ix,ix=ix+1|0)]=new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(childCenter,childRect.getTop()),new Staffer.OrgChart.Layout.Point.$ctor1(childCenter,childRect.getTop()-this.childConnectorHookLength)));for(lastChildHookIndex=(count-node.getState().numberOfSiblingRows|0)-1|0,firstInRowIndex=1;firstInRowIndex<(count-node.getState().numberOfSiblingRows|0);firstInRowIndex=firstInRowIndex+this.maxSiblingsPerRow|0)firstInRow=segments[firstInRowIndex],lastInRow=segments[Math.min((firstInRowIndex+this.maxSiblingsPerRow|0)-1|0,lastChildHookIndex)],segments[Bridge.identity(ix,ix=ix+1|0)]=lastInRow.from.x<segments[0].from.x?new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(firstInRow.to.x,firstInRow.to.y),new Staffer.OrgChart.Layout.Point.$ctor1(segments[0].to.x,firstInRow.to.y)):new Staffer.OrgChart.Layout.Edge.$ctor1(new Staffer.OrgChart.Layout.Point.$ctor1(firstInRow.to.x,firstInRow.to.y),new Staffer.OrgChart.Layout.Point.$ctor1(lastInRow.to.x,firstInRow.to.y));node.getElement().frame.connector=new Staffer.OrgChart.Layout.Connector(segments)}});var $m=Bridge.setMetadata,$n=[Staffer.OrgChart.Layout,System,System.Collections.Generic,Staffer.OrgChart.Misc,Staffer.OrgChart.Annotations,Staffer.OrgChart.Test];$m($n[4].ContractAnnotationAttribute,function(){return{m:[{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],a:2,n:"Contract",t:16,rt:String,g:{a:2,n:"get_Contract",t:8,sn:"getContract",rt:String},s:{a:1,n:"set_Contract",t:8,pi:[{n:"value",pt:String,ps:0}],sn:"setContract",rt:Object,p:[String]}}],am:!0}});$m($n[0].Boundary.Step,function(){return{at:[new System.Diagnostics.DebuggerDisplayAttribute("{X}, {Top} - {Bottom}, {Box.Id}")],m:[{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],a:2,n:"Box",t:4,rt:$n[0].Box,sn:"box",ro:!0}]}});$m($n[0].Box,function(){return{at:[new System.Diagnostics.DebuggerDisplayAttribute("{Id}, {Frame.Exterior.Left}:{Frame.Exterior.Top}, {Frame.Exterior.Size.Width}x{Frame.Exterior.Size.Height}")],m:[{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],a:2,n:"Special",is:!0,t:8,pi:[{n:"id",pt:$n[1].Int32,ps:0},{n:"visualParentId",pt:$n[1].Int32,ps:1},{n:"disableCollisionDetection",pt:Boolean,ps:2}],sn:"special",rt:$n[0].Box,p:[$n[1].Int32,$n[1].Int32,Boolean]},{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"AssistantLayoutStrategyId",t:4,rt:String,sn:"assistantLayoutStrategyId"},{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"DataId",t:4,rt:String,sn:"dataId",ro:!0},{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],a:2,n:"Frame",t:4,rt:$n[0].Frame,sn:"frame",ro:!0},{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"LayoutStrategyId",t:4,rt:String,sn:"layoutStrategyId"}]}});$m($n[0].BoxContainer,function(){return{m:[{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"SystemRoot",t:16,rt:$n[0].Box,g:{a:2,n:"get_SystemRoot",t:8,sn:"getSystemRoot",rt:$n[0].Box},s:{a:2,n:"set_SystemRoot",t:8,pi:[{n:"value",pt:$n[0].Box,ps:0}],sn:"setSystemRoot",rt:Object,p:[$n[0].Box]}}]}});$m($n[0].NodeLayoutInfo,function(){return{m:[{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],a:2,n:"RequireLayoutStrategy",t:8,sn:"requireLayoutStrategy",rt:$n[0].LayoutStrategyBase}]}});$m($n[0].Connector,function(){return{m:[{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],a:2,n:"Segments",t:16,rt:Array,g:{a:2,n:"get_Segments",t:8,sn:"getSegments",rt:Array},s:{a:1,n:"set_Segments",t:8,pi:[{n:"value",pt:Array,ps:0}],sn:"setSegments",rt:Object,p:[Array]}}]}});$m($n[0].Diagram,function(){return{m:[{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"VisualTree",t:16,rt:$n[0].BoxTree,g:{a:2,n:"get_VisualTree",t:8,sn:"getVisualTree",rt:$n[0].BoxTree},s:{a:2,n:"set_VisualTree",t:8,pi:[{n:"value",pt:$n[0].BoxTree,ps:0}],sn:"setVisualTree",rt:Object,p:[$n[0].BoxTree]}}]}});$m($n[0].DiagramLayoutSettings,function(){return{m:[{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"DefaultAssistantLayoutStrategyId",t:16,rt:String,g:{a:2,n:"get_DefaultAssistantLayoutStrategyId",t:8,sn:"getDefaultAssistantLayoutStrategyId",rt:String},s:{a:2,n:"set_DefaultAssistantLayoutStrategyId",t:8,pi:[{n:"value",pt:String,ps:0}],sn:"setDefaultAssistantLayoutStrategyId",rt:Object,p:[String]}},{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"DefaultLayoutStrategyId",t:16,rt:String,g:{a:2,n:"get_DefaultLayoutStrategyId",t:8,sn:"getDefaultLayoutStrategyId",rt:String},s:{a:2,n:"set_DefaultLayoutStrategyId",t:8,pi:[{n:"value",pt:String,ps:0}],sn:"setDefaultLayoutStrategyId",rt:Object,p:[String]}},{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],a:2,n:"LayoutStrategies",t:16,rt:$n[2].Dictionary$2(String,Staffer.OrgChart.Layout.LayoutStrategyBase),g:{a:2,n:"get_LayoutStrategies",t:8,sn:"getLayoutStrategies",rt:$n[2].Dictionary$2(String,Staffer.OrgChart.Layout.LayoutStrategyBase)},s:{a:1,n:"set_LayoutStrategies",t:8,pi:[{n:"value",pt:$n[2].Dictionary$2(String,Staffer.OrgChart.Layout.LayoutStrategyBase),ps:0}],sn:"setLayoutStrategies",rt:Object,p:[$n[2].Dictionary$2(String,Staffer.OrgChart.Layout.LayoutStrategyBase)]}}]}});$m($n[0].Frame,function(){return{at:[new System.Diagnostics.DebuggerDisplayAttribute("{Exterior.Left}:{Exterior.Top}, {Exterior.Size.Width}x{Exterior.Size.Height}")],m:[{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"Connector",t:4,rt:$n[0].Connector,sn:"connector"}]}});$m($n[0].IChartDataSource,function(){return{m:[{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],ab:!0,a:2,n:"AllDataItemIds",t:16,rt:$n[2].IEnumerable$1(String),g:{ab:!0,a:2,n:"get_AllDataItemIds",t:8,sn:"Staffer$OrgChart$Layout$IChartDataSource$getAllDataItemIds",rt:$n[2].IEnumerable$1(String)},s:{ab:!0,a:1,n:"set_AllDataItemIds",t:8,pi:[{n:"value",pt:$n[2].IEnumerable$1(String),ps:0}],sn:"Staffer$OrgChart$Layout$IChartDataSource$setAllDataItemIds",rt:Object,p:[$n[2].IEnumerable$1(String)]}},{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],ab:!0,a:2,n:"GetDataItemFunc",t:16,rt:Function,g:{ab:!0,a:2,n:"get_GetDataItemFunc",t:8,sn:"Staffer$OrgChart$Layout$IChartDataSource$getGetDataItemFunc",rt:Function},s:{ab:!0,a:1,n:"set_GetDataItemFunc",t:8,pi:[{n:"value",pt:Function,ps:0}],sn:"Staffer$OrgChart$Layout$IChartDataSource$setGetDataItemFunc",rt:Object,p:[Function]}},{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],ab:!0,a:2,n:"GetParentKeyFunc",t:16,rt:Function,g:{ab:!0,a:2,n:"get_GetParentKeyFunc",t:8,sn:"Staffer$OrgChart$Layout$IChartDataSource$getGetParentKeyFunc",rt:Function},s:{ab:!0,a:1,n:"set_GetParentKeyFunc",t:8,pi:[{n:"value",pt:Function,ps:0}],sn:"Staffer$OrgChart$Layout$IChartDataSource$setGetParentKeyFunc",rt:Object,p:[Function]}}]}});$m($n[0].LayoutState,function(){return{m:[{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"BoxSizeFunc",t:16,rt:Function,g:{a:2,n:"get_BoxSizeFunc",t:8,sn:"getBoxSizeFunc",rt:Function},s:{a:2,n:"set_BoxSizeFunc",t:8,pi:[{n:"value",pt:Function,ps:0}],sn:"setBoxSizeFunc",rt:Object,p:[Function]}},{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],a:2,n:"Diagram",t:16,rt:$n[0].Diagram,g:{a:2,n:"get_Diagram",t:8,sn:"getDiagram",rt:$n[0].Diagram},s:{a:1,n:"set_Diagram",t:8,pi:[{n:"value",pt:$n[0].Diagram,ps:0}],sn:"setDiagram",rt:Object,p:[$n[0].Diagram]}},{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],a:1,n:"m_layoutStack",t:4,rt:$n[2].Stack$1(Staffer.OrgChart.Layout.LayoutState.LayoutLevel),sn:"m_layoutStack",ro:!0},{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],a:1,n:"m_pooledBoundaries",t:4,rt:$n[2].List$1(Staffer.OrgChart.Layout.Boundary),sn:"m_pooledBoundaries",ro:!0},{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"BoundaryChanged",t:2,ad:{a:2,n:"add_BoundaryChanged",t:8,pi:[{n:"value",pt:Function,ps:0}],sn:"addBoundaryChanged",rt:Object,p:[Function]},r:{a:2,n:"remove_BoundaryChanged",t:8,pi:[{n:"value",pt:Function,ps:0}],sn:"removeBoundaryChanged",rt:Object,p:[Function]}},{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"OperationChanged",t:2,ad:{a:2,n:"add_OperationChanged",t:8,pi:[{n:"value",pt:Function,ps:0}],sn:"addOperationChanged",rt:Object,p:[Function]},r:{a:2,n:"remove_OperationChanged",t:8,pi:[{n:"value",pt:Function,ps:0}],sn:"removeOperationChanged",rt:Object,p:[Function]}}]}});$m($n[0].LayoutState.LayoutLevel,function(){return{at:[new System.Diagnostics.DebuggerDisplayAttribute("{BranchRoot.Element.Id}, {Boundary.BoundingRect.Top}..{Boundary.BoundingRect.Bottom}")]}});$m($n[3].Tree$3.TreeNode,function(TKey,TValue,TValueState){return{m:[{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"AssistantsRoot",t:16,rt:$n[3].Tree$3.TreeNode(TKey,TValue,TValueState),g:{a:2,n:"get_AssistantsRoot",t:8,sn:"getAssistantsRoot",rt:$n[3].Tree$3.TreeNode(TKey,TValue,TValueState)},s:{a:3,n:"set_AssistantsRoot",t:8,pi:[{n:"value",pt:$n[3].Tree$3.TreeNode(TKey,TValue,TValueState),ps:0}],sn:"setAssistantsRoot",rt:Object,p:[$n[3].Tree$3.TreeNode(TKey,TValue,TValueState)]}},{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"Children",t:16,rt:$n[2].IList$1(Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState)),g:{a:2,n:"get_Children",t:8,sn:"getChildren",rt:$n[2].IList$1(Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState))},s:{a:3,n:"set_Children",t:8,pi:[{n:"value",pt:$n[2].IList$1(Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState)),ps:0}],sn:"setChildren",rt:Object,p:[$n[2].IList$1(Staffer.OrgChart.Misc.Tree$3.TreeNode(TKey,TValue,TValueState))]}},{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"ParentNode",t:16,rt:$n[3].Tree$3.TreeNode(TKey,TValue,TValueState),g:{a:2,n:"get_ParentNode",t:8,sn:"getParentNode",rt:$n[3].Tree$3.TreeNode(TKey,TValue,TValueState)},s:{a:2,n:"set_ParentNode",t:8,pi:[{n:"value",pt:$n[3].Tree$3.TreeNode(TKey,TValue,TValueState),ps:0}],sn:"setParentNode",rt:Object,p:[$n[3].Tree$3.TreeNode(TKey,TValue,TValueState)]}},{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],a:2,n:"State",t:16,rt:TValueState,g:{a:2,n:"get_State",t:8,sn:"getState",rt:TValueState},s:{a:1,n:"set_State",t:8,pi:[{n:"value",pt:TValueState,ps:0}],sn:"setState",rt:Object,p:[TValueState]}}]}});$m($n[0].Rect,function(){return{at:[new System.Diagnostics.DebuggerDisplayAttribute("{TopLeft.X}:{TopLeft.Y}, {Size.Width}x{Size.Height}")]}});$m($n[5].TestDataItem,function(){return{m:[{at:[new Staffer.OrgChart.Annotations.NotNullAttribute],a:2,n:"Id",t:16,rt:String,g:{a:2,n:"get_Id",t:8,sn:"getId",rt:String},s:{a:2,n:"set_Id",t:8,pi:[{n:"value",pt:String,ps:0}],sn:"setId",rt:Object,p:[String]}},{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"ParentId",t:16,rt:String,g:{a:2,n:"get_ParentId",t:8,sn:"getParentId",rt:String},s:{a:2,n:"set_ParentId",t:8,pi:[{n:"value",pt:String,ps:0}],sn:"setParentId",rt:Object,p:[String]}},{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"String1",t:16,rt:String,g:{a:2,n:"get_String1",t:8,sn:"getString1",rt:String},s:{a:2,n:"set_String1",t:8,pi:[{n:"value",pt:String,ps:0}],sn:"setString1",rt:Object,p:[String]}},{at:[new Staffer.OrgChart.Annotations.CanBeNullAttribute],a:2,n:"String2",t:16,rt:String,g:{a:2,n:"get_String2",t:8,sn:"getString2",rt:String},s:{a:2,n:"set_String2",t:8,pi:[{n:"value",pt:String,ps:0}],sn:"setString2",rt:Object,p:[String]}}]}})});